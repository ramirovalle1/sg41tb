{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script src='/static/js/jquery.validationEngine.js' type="text/javascript"></script>
    <script src='/static/js/jquery.validationEngine-es.js' type="text/javascript"></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css"/>

    <script type="text/javascript">
        var cronometro;
        $(function() {

            var cansincontestar = '{{ NUMERO_PREGUNTA }}';
            var numsincontestar =  '';
            var idpreguntas =  [];
            $(".elegir").click(function(){
                $('#'+$(this).attr('alt')).removeClass('alert alert-danger');
                var idcambia = $(this).data("id");
                var respid = $(this).attr("respid");
                var check=false;
                var objet=this;
                if ($(this).is(':checked')) {
                    check=true;
                }
                showWaiting("Guardando respuesta","Espere unos segundos por favor...");
                $.post("/examen_conduc",{'idresp': respid, 'idinscrip':'{{ inscripcion.id }}',check:check, "segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'addrespuesta'}, function(data) {
                    hideWaiting();
                    if (data.result=='bad'){
                        $(objet).attr('checked',!check);
                        smoke.alert('Error vuelva a intentarlo ('+ data.mensaje+')');

                    }else if(data.result=='ok'){
                        cansincontestar = data.sinconte;
                        numsincontestar = data.html;
                        idpreguntas= data.idpre;
                    }

                }, "json").fail(function() {
                                        hideWaiting();
                                        $(objet).attr('checked',!check);
                                        smoke.alert('Error de conexi&oacute;n vuelva a intentarlo');
                          });

                var idcabecera="#cabecera"+ $(this).attr('numero') +" input";

                $.each($(idcabecera), function () {

                    if (parseInt(idcambia) != parseInt($(this).data("id"))) {
                        $("#respuesta"+$(this).data("id")).attr('checked',false)
                    }

                });
            });

{#            /////////////////////////////////////////////////////////////////////////////////////////////#}
{#            /////////////////////////////////////////////////////////////////////////////////////////////#}
            var cronometro;

            var contador_s;
            var contador_h;
            var contador_m;
            function detenerse()
            {
                clearInterval(cronometro);
            }

            function carga()
            {
                contador_s ={{ segundos }};
                contador_m ={{ minutos }};
                contador_h ={{ horas }};
                s = document.getElementById("segundos");
                m = document.getElementById("minutos");
                h = document.getElementById("horas");
                cronometro = setInterval(
                    function(){
                        if(contador_s==0)
                        {

                            if(contador_m!=0 )
                            {
                                contador_s=59;
                                contador_m--;

                            }
                            if (String(contador_m).length == 1)
                            {
                                m.innerHTML = '0'+String(contador_m)
                            }
                            else{
                                m.innerHTML = contador_m;
                            }
                            if(contador_m==0)
                            {
                                if(contador_h!=0 && contador_s == 0)
                                {

                                    contador_s=59;
                                    contador_m=59;
                                    contador_h--;

                                }
                                if (String(contador_m).length == 1)
                                {
                                    m.innerHTML = '0'+String(contador_m)
                                }
                                else{
                                    m.innerHTML = contador_m;
                                }

                                if (String(contador_h).length == 1)
                                {
                                    h.innerHTML = '0'+String(contador_h)
                                }
                                else{
                                    h.innerHTML = contador_h;
                                }


                                if(contador_h==0)                                            {

                                    if(contador_m==0)
                                    {
                                        if(contador_s==0 )
                                        {
{#                                            $("#enviar").click();#}
                                            clearInterval(cronometro);
                                            clearInterval(cronometro1);
                                            $.post("/examen_conduc",{'idinscrip':'{{ inscripcion.id }}', "idtituex":{{ tituloexamencondu.id }},"segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'finalizar'}, function(data) {
                                                if (data.result=='ok'){
                                                  window.open('/examen_conduc?action=examen&id='+{{ tituloexamencondu.id }},"Examen", 'width='+(screen.availWidth)+',height ='+(screen.availHeight)+',fullscreen=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=no');
                                                }
                                            }, "json").fail(function() {
                                                        hideWaiting();
                                                        smoke.alert('Error de conexi&oacute;n al guardar el examen, cierre y vuelva a ingresar');
                                          });
                                        }
                                    }
                                }
                            }
                        }

                        if (String(contador_s).length == 1)
                        {
                            s.innerHTML = '0'+String(contador_s)
                        }
                        else{
                            s.innerHTML = contador_s;
                        }
                        contador_s--;
                    }
                    ,1000);
            }

            {% if inscripcion and not tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                carga();


                var ctrlKeyDown = false;

                $(document).ready(function(){
                    $(document).on("keydown", keydown);
                    $(document).on("keyup", keyup);
                    $(window).on("keydown",keydown);
                    $(window).on("keyup",keyupwin);

                });

                function keydown(e) {

                    if ((e.which || e.keyCode) == 116 || ((e.which || e.keyCode) == 82 && ctrlKeyDown)) {
                        // Pressing F5 or Ctrl+R
                        e.preventDefault();
                    } else if ((e.which || e.keyCode) == 17) {
                        // Pressing  only Ctrl
                        ctrlKeyDown = true;
                    }
                }

                function keyup(e){
                    // Key up Ctrl
                    if ((e.which || e.keyCode) == 17){
                        ctrlKeyDown = false;}
                }

                function keyupwin(e){
                    // Key up Ctrl
                    if ((e.which || e.keyCode) == 17){
                        $.post("/examen_conduc",{'idinscrip':'{{ inscripcion.id }}', "idtituex":{{ tituloexamencondu.id }},"segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'actualizatime'}, function(data) {


                    }, "json").fail(function() {
                                        hideWaiting();
                                        smoke.alert('Error de conexi&oacute;n, cierre y vuelva a ingresar');
                          });
                    ctrlKeyDown = false;}
                }

                document.oncontextmenu = new Function("return false");

                history.pushState(null, null, location.href);

                window.addEventListener('popstate', function(event) {
                    history.pushState(null, null, location.href);

                });
                var tiem = 120;
                var cronometro1;
                cronometro1 = setInterval(
                function(){
                       if(tiem==0)
                       {
                           tiem=120;
                           if(parseInt(contador_h) != 0 || parseInt(contador_m) != 0 || parseInt(contador_s) != 0 )
                           {
                            $.post("/examen_conduc",{'idinscrip':'{{ inscripcion.id }}', "idtituex":{{ tituloexamencondu.id }},"segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'actualizatime'}, function(data) {


                            }, "json").fail(function() {
                                        hideWaiting();
                                        smoke.alert('Error de conexi&oacute;n, cierre y vuelva a ingresar');
                                      });
                           }
        {#                      clearInterval(cronometro);#}
                       }
                    tiem--;
                   },1000);
                $(".pagination").click(function(){
                       if(parseInt(contador_h) != 0 || parseInt(contador_m) != 0 || parseInt(contador_s) != 0 )
                       {
                        $.post("/examen_conduc",{'idinscrip':'{{ inscripcion.id }}', "idtituex":{{ tituloexamencondu.id }},"segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'actualizatime'}, function(data) {


                        }, "json").fail(function() {
                            hideWaiting();
                            smoke.alert('Error de conexi&oacute;n, cierre y vuelva a ingresar');
                          });
                       }
                });

                $(".brand").hide();
                $(".nav").hide();
                $("#verifica").click(function(){
                    var mensajeconfirm =  'Se finalizara el examen?';
                    {% if DEFAULT_PASSWORD == "itb" %}
                        if(parseInt(cansincontestar)> 0){
                            for (var i in idpreguntas){
                                $('#'+idpreguntas[i].id).addClass('alert alert-danger')
                            }
                            mensajeconfirm = 'Se finalizar&aacute; el examen con '+cansincontestar+'  preguntas sin responder. ' +numsincontestar+' Est&aacute; seguro?';
                        }
                    {% endif %}

                    smoke.confirm( mensajeconfirm, function(e){
                        if (e){
                            $("#verifica").hide();
                            $.post("/examen_conduc",{'idinscrip':'{{ inscripcion.id }}', "idtituex":{{ tituloexamencondu.id }},"segun":contador_s, "minut":contador_m , "hora":contador_h ,'action': 'finalizar'}, function(data) {
                                if (data.result=='ok'){
                                  window.open('/examen_conduc?action=examen&id='+{{ tituloexamencondu.id }},"Examen", 'width='+(screen.availWidth)+',height ='+(screen.availHeight)+',fullscreen=yes,menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=no');
                                }else{
                                    smoke.alert("Error Guarde nuevamente ("+data.mensaje+")");
                                    $("#verifica").show();
                                }

                            }, "json").fail(function() {
                                        hideWaiting();
                                        smoke.alert('Error de conexi&oacute;n al guardar el examen, cierre y vuelva a ingresar');
                                  });

                        }
                        else{
                        }
                        }, {
                        ok: "CONTINUAR",
                        cancel: 'CANCELAR',
                        classname: "custom-class",
                        reverseButtons: true
                    });
                });
            {% endif %}


            $("#cerrarexam").click(function(){window.close();});
            $(".brand").hide();
            $(".nav").hide();
        });


    </script>

{% endblock %}
{% block canvas %}
    <div class='row-fluid' style="text-align: center" >
        <div class="offset2 span8" >
            {% if inscripcion %}<h3>Alumno: {{ inscripcion.persona.nombre_completo }}</h3> {% endif %}
            <h3>{{ tituloexamencondu.nombreinstitucion }}</h3>
            <h4>{{ tituloexamencondu.tituloexamen }}</h4>
            <h5>{{ tituloexamencondu.subtituloexamen }}</h5>
            <br/>
        </div>
        <div class='span1'>
            {% if inscripcion and not tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                <div style="position: fixed">
                    <button class="btn ">
                        <p style="font-size: 30px;margin-top: 10px" >
                         <span id="horas">{{ horas }}</span>:<span id="minutos">{{ minutos }}</span>:<span id="segundos">{{ segundos }}</span>
                        </p>
                    </button>
                </div>
            {% endif %}
            {% if not inscripcion %}
                <a href="/examen_conduc" class='btn'><i class="icon-arrow-left"></i> Atr&aacute;s</a>
            {% endif %}
        </div>

    </div>


        <div class='row-fluid'>
        <div class='offset2 span8' >
            <form class='form' method="POST">
                <table class='table' cellpadding="0" cellspacing="0" id="tablepregunto">
                    {% if inscripcion %}
                        {% for p in preguntaexamen %}
                            {% with num=forloop.counter %}
                                        <thead num="{{ num }}" id="cabecera{{ num }}">
                                            <tr>
                                                <th id='{{ p.respuestaexamen.preguntaexamen.id }}' colspan="{% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}4 {% else %} 4{% endif %}">
                                                    <h4 {% if DEFAULT_PASSWORD == "itb" %} style="white-space: pre-wrap;text-align: justify;" {% endif %}>{{ forloop.counter }}.- {{ p.respuestaexamen.preguntaexamen.pregunta }} <br><span style="float: right">Puntaje: {{ p.respuestaexamen.preguntaexamen.puntos }}</span>
                                                   </h4>
                                                </th>
                                            </tr>
                                            {% if p.respuestaexamen.preguntaexamen.imagen %}
                                                <tr>
                                                    <td colspan="{% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}3{% else %} 2{% endif %}">

                                                            <div class="thumbnail" style="height: 150px">

                                                                <img src="{{ p.respuestaexamen.preguntaexamen.imagen.url }}" alt="" style="width: 150px;height: 150px">

                                                            </div>

                                                    </td>
                                                    <td>
                                                    </td>
                                                </tr>
                                            {% endif %}

                                            {% if inscripcion and not tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                {% for r in p.respuestaexamen.preguntaexamen.respuestaexamen %}
                                                    <tr
                                                        {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                           {% if r.valida %} style="background: rgba(0, 128, 0, 0.28);"{% endif %}
                                                        {% endif %}
                                                        {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                        {% if not inscripcion and r.valida %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                    >
                                                        <td>
                                                            {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                   {% if r.valida %} <a style="float: left;"><img src='/static/images/16/check.png' alt='' border="0"/></a>{% else %}<a style="float: left"><img src='/static/images/16/delete2.png' alt='' border="0"/></a>{% endif %}
                                                            {% endif %}
                                                            {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                            {% if not inscripcion and r.valida %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% if DEFAULT_PASSWORD == "itb" %}<b style="color: red">R{{ forloop.counter }}.-</b>{% else %}{{ forloop.counter }}.-{% endif %} {{ r.respuesta }}
                                                        </td>
                                                        <td>
                                                            {% if r.imagen %}
                                                                <div class="thumbnail" style="height: 50px;"  >

                                                                    <img src="{{ r.imagen.url }}" alt="" style="width: 50px;height: 50px">

                                                                </div>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            {% if inscripcion %}
                                                                <input  type="checkbox" respid="{{ r.id }}" class="elegir" numero="{{ num }}" data-id="{{ num }}{{ forloop.counter }}" alt='{{ p.respuestaexamen.preguntaexamen.id }}'
                                                                       name='respuesta{{ num }}{{ forloop.counter }}' id="respuesta{{ num }}{{ forloop.counter }}"
                                                                       {% if r|args:inscripcion.id|call:"exist_respuesta" %} {% with respdet=r|args:inscripcion.id|call:"exist_respuesta" %} {% if respdet.fecha %}checked {% endif %}{% endwith %}{% endif %}
                                                                        {% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %} disabled {% endif %} />

                                                            {% endif %}
                                                        </td>

                                                    </tr>
                                                {% endfor %}
                                            {% else %}
                                                {% for r in p.respuestaexamen.preguntaexamen.respuesta %}
                                                    <tr
                                                        {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                           {% if r.valida %} style="background: rgba(0, 128, 0, 0.28);"{% endif %}
                                                        {% endif %}
                                                        {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                        {% if not inscripcion and r.valida %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                    >
                                                        <td {% if  DEFAULT_PASSWORD == "itb" %}style="width: 5%"{% endif %}>
                                                            {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                   {% if r.valida %} <a style="float: left;"><img src='/static/images/16/check.png' alt='' border="0"/></a>{% else %}<a style="float: left"><img src='/static/images/16/delete2.png' alt='' border="0"/></a>{% endif %}
                                                            {% endif %}
                                                            {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                            {% if not inscripcion and r.valida %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% if DEFAULT_PASSWORD == "itb" %}<b style="color: red">R{{ forloop.counter }}.-</b>{% else %}{{ forloop.counter }}.-{% endif %} {{ r.respuesta }}
                                                        </td>
                                                        <td>
                                                            {% if r.imagen %}
                                                                <div class="thumbnail" style="height: 50px;"  >

                                                                    <img src="{{ r.imagen.url }}" alt="" style="width: 50px;height: 50px">

                                                                </div>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            {% if inscripcion %}
                                                                <input style="float: right;width: 8%;height: 3em" class="form-check-input"  type="checkbox" respid="{{ r.id }}" class="elegir" numero="{{ num }}" data-id="{{ num }}{{ forloop.counter }}"
                                                                       name='respuesta{{ num }}{{ forloop.counter }}' id="respuesta{{ num }}{{ forloop.counter }}"
                                                                       {% if r|args:inscripcion.id|call:"exist_respuesta" %} checked
                                                                       {% endif %}
                                                                        {% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %} disabled {% endif %} />
                                                                        {% if r|args:inscripcion.id|call:"exist_respuesta" %}
                                                                            {% if not r.valida  and DEFAULT_PASSWORD == "itb" %}
                                                                                    <br><span style="float: left" class="label label-warning">Respuesta seleccionada Incorrecta</span>
                                                                            {% else %}
                                                                                <br><span style="float: left" class="label label-info">La Respuesta seleccionada es correcta</span>
                                                                            {% endif %}
                                                                        {% endif %}
                                                                        {% if not p.fecha and DEFAULT_PASSWORD == "itb" %} &nbsp;<a style="float: right"><img src='/static/images/16/delete2.png' alt='' border="0"/></a>
                                                                            {% if forloop.last %}
                                                                                <br><span style="float: left" class="label label-important">No selecciono ninguna respuesta</span>
                                                                            {% endif %}
                                                                        {% endif %}

                                                            {% endif %}
                                                        </td>

                                                    </tr>
                                                {% endfor %}
                                            {% endif %}


                                        </thead>
                            {% endwith %}
                        {% endfor %}
                    {% else %}

                        {% for p in preguntaexamen %}
                            {% with num=forloop.counter %}
                                        <thead num="{{ num }}" id="cabecera{{ num }}">
                                            <tr>
                                                <th colspan="{% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}4 {% else %}4{% endif %}">
                                                    <h4 {% if DEFAULT_PASSWORD == "itb" %} style="white-space: pre-wrap;text-align: justify;" {% endif %}>{% if not inscripcion %}{{ p.numero }}{% else %}{{ forloop.counter }} {% endif %}.- {{ p.pregunta }} <br><span style="float: right">Puntaje: {{ p.puntos }}</span>
                                                   </h4>
                                                </th>
                                            </tr>
                                            {% if p.imagen %}
                                                <tr>
                                                    <td colspan="{% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}3{% else %} 2{% endif %}">

                                                            <div class="thumbnail" style="height: 150px">

                                                                <img src="{{ p.imagen.url }}" alt="" style="width: 150px;height: 150px">

                                                            </div>

                                                    </td>
                                                    <td>
                                                    </td>
                                                </tr>
                                            {% endif %}

                                            {% if inscripcion and not tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                {% for r in p.respuestaexamen %}
                                                    <tr
                                                        {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                           {% if r.valida %} style="background: rgba(0, 128, 0, 0.28);"{% endif %}
                                                        {% endif %}
                                                        {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                        {% if not inscripcion and r.valida %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                    >
                                                        <td>
                                                            {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                   {% if r.valida %} <a style="float: left;"><img src='/static/images/16/check.png' alt='' border="0"/></a>{% else %}<a style="float: left"><img src='/static/images/16/delete2.png' alt='' border="0"/></a>{% endif %}
                                                            {% endif %}
                                                            {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                            {% if not inscripcion and r.valida %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% if DEFAULT_PASSWORD == "itb" %}<b style="color: red">R{{ forloop.counter }}.-</b>{% else %}{{ forloop.counter }}.-{% endif %} {{ r.respuesta }}
                                                        </td>
                                                        <td>
                                                            {% if r.imagen %}
                                                                <div class="thumbnail" style="height: 50px;"  >

                                                                    <img src="{{ r.imagen.url }}" alt="" style="width: 50px;height: 50px">

                                                                </div>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            {% if inscripcion %}
                                                                <input type="checkbox" style="width: 8%;height: 3em" respid="{{ r.id }}" class="elegir" numero="{{ num }}" data-id="{{ num }}{{ forloop.counter }}"
                                                                       name='respuesta{{ num }}{{ forloop.counter }}' id="respuesta{{ num }}{{ forloop.counter }}"
                                                                       {% if r|args:inscripcion.id|call:"exist_respuesta" %} {% with respdet=r|args:inscripcion.id|call:"exist_respuesta" %} {% if respdet.fecha %}checked {% endif %}{% endwith %}{% endif %}
                                                                        {% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %} disabled {% endif %} />

                                                            {% endif %}
                                                        </td>

                                                    </tr>
                                                {% endfor %}
                                            {% else %}
                                                {% for r in p.respuesta %}
                                                    <tr
                                                        {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                           {% if r.valida %} style="background: rgba(0, 128, 0, 0.28);"{% endif %}
                                                        {% endif %}
                                                        {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                        {% if not inscripcion and r.valida %}
                                                            style="background: rgba(0, 128, 0, 0.28);"
                                                        {% endif %}
                                                    >
                                                        <td>
                                                            {% if inscripcion and r|args:inscripcion.id|call:"exist_respuesta" and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                   {% if r.valida %} <a style="float: left;"><img src='/static/images/16/check.png' alt='' border="0"/></a>{% else %}<a style="float: left"><img src='/static/images/16/delete2.png' alt='' border="0"/></a>{% endif %}
                                                            {% endif %}
                                                            {% if inscripcion and not r|args:inscripcion.id|call:"exist_respuesta" and r.valida and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                            {% if not inscripcion and r.valida %}
                                                                <a style="float: left"><img src='/static/images/16/check.png' alt='' border="0"/></a>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{% if DEFAULT_PASSWORD == "itb" %}<b style="color: red">R{{ forloop.counter }}.-</b>{% else %}{{ forloop.counter }}.-{% endif %} {{ r.respuesta }}
                                                        </td>
                                                        <td>
                                                            {% if r.imagen %}
                                                                <div class="thumbnail" style="height: 50px;"  >

                                                                    <img src="{{ r.imagen.url }}" alt="" style="width: 50px;height: 50px">

                                                                </div>
                                                            {% endif %}
                                                        </td>
                                                        <td>
                                                            {% if inscripcion %}
                                                                <input style="width: 8%;height: 3em" type="checkbox" respid="{{ r.id }}" class="elegir" numero="{{ num }}" data-id="{{ num }}{{ forloop.counter }}"
                                                                       name='respuesta{{ num }}{{ forloop.counter }}' id="respuesta{{ num }}{{ forloop.counter }}"
                                                                       {% if r|args:inscripcion.id|call:"exist_respuesta" %} checked {% endif %}
                                                                        {% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %} disabled {% endif %} />

                                                            {% endif %}
                                                        </td>

                                                    </tr>
                                                {% endfor %}
                                            {% endif %}


                                        </thead>
                            {% endwith %}
                        {% endfor %}
                    {% endif %}

                </table>
                {% if inscripcion and   paging.num_pages == page.number and not tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                    <a id="verifica"  class="btn btn-success">Finalizar

                    </a>
                {% else %}
                    {% if tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                        <a id="cerrarexam"  class="btn btn-danger" >Cerrar

                        </a>
                    {% endif %}
                {% endif %}
            </form>
        </div>
        {% if inscripcion and tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
            <div class='span1'>
                {% with examen=tituloexamencondu|args:inscripcion.id|call:"exist_tituexamenfin" %}
                    <h3>PUNTOS:</h3><a class="btn btn-large {% if DEFAULT_PASSWORD != "itb" %}
                                                {% if examen.puntaje >= NOTA_PARA_EXAMEN_CONDUCCION %}btn-success{% else %}btn-danger{% endif %}{% else %}
                                                {% if examen.puntaje >= EXAMEN_TEORI_COMPLEX %}btn-success{% else %}btn-block{% endif %}
                                                {% endif %}" style="font-size: 32px">
                        {% if examen.puntaje %}{{ examen.puntaje }}{% else %}0.0{% endif %}
                    </a>
{#                    {% endwith %}#}
{#                    {% with deta=tituloexamencondu|args:inscripcion.id|call:"cantidadresp" %}#}
                    <h3>Respuestas Correctas:</h3><a class="btn btn-large {% if DEFAULT_PASSWORD != "itb" %}
                                                {% if examen.cantidadresp >= NOTA_PARA_EXAMEN_CONDUCCION %}btn-success{% else %}btn-danger{% endif %}{% else %}
                                                btn-info
                                                {% endif %}" style="font-size: 32px">
                        {{ examen.cantidadresp }}/{{ examen.cantpregunta }}
                    </a>
                    {% if DEFAULT_PASSWORD == "itb" %}
                        <h3>Respuestas Incorrectas:</h3><a class="btn btn-large  btn-warning" style="font-size: 32px">
                            {{ examen.cantidadrespincorr }}/{{ examen.cantpregunta }}
                        </a>
                        <h3>Sin contestar:</h3><a class="btn btn-large  btn-danger" style="font-size: 32px">
                            {{ examen.cantidadrespsincont }}/{{ examen.cantpregunta }}
                        </a>
                    {% endif %}
                {% endwith %}

            </div>
        {% endif %}
{#        <a id="verifica"  class="btn btn-success">cerrar</a>#}
    </div>

    <div class='row-fluid'>
        <div class="offset2 span8">


            {% if paging.num_pages > 20 %}
                <div class='pagination'>
                    <ul >
                        {% if paging.primera_pagina %}
                            <li><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&page=1">1</a></li>
                            <li><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&page={{ paging.ellipsis_izquierda }}" class="active">...</a></li>
                        {% endif %}
                        {% for pagenumber in paging.paginas %}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&page={{ pagenumber }}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>
                        {% endfor %}
                        {% if paging.ultima_pagina %}
                            <li><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&page={{ paging.ellipsis_derecha }}" class="active">...</a></li>
                            <li><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&page={{ paging.num_pages }}">{{ paging.num_pages }}</a></li>
                        {% endif %}
                    </ul>
                </div>
            {% else %}

                <div class='pagination'>
                    <ul>
                        {% for pagenumber in paging.page_range %}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/examen_conduc?action=examen&id={{ tituloexamencondu.id }}&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>
                        {% endfor %}
                    </ul>
                </div>

            {% endif %}

        </div>
    </div>


{% endblock %}