{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}

    <script type="text/javascript">
        $(function() {

           $("#id_material,#id_bancopregunta").addClass('validate[required]');
            var materia=0;
            var segmentomateria=0;
            $(".profesormateria").click(function() {
                $.blockUI({message: null});
                var pmid = $(this).attr("pmid");
                var self = this;
                $.post("/niveles", {'action': 'delprofesor', 'pmid': pmid}, function(data) {
                    $.unblockUI();
                    $(self.parentNode.parentNode).remove();
                }, "json");
            })

            $(".selectorfecha").datepicker({format:"dd-mm-yyyy"});
            $(".selectorfecha").blur(function() {
                var mid = $(this).attr("mid");
                var horas = $("#horas"+mid).val();
                var fecha = $(this).val();
                var inicio = $(this).hasClass("fechainicio");
                $.blockUI({message: null});
                $.post("/niveles", {'action': 'updatefecha', 'horas': horas, 'mid': mid, 'fecha': fecha, 'inicio': inicio}, function(data) {
                    $.unblockUI();
                    if (data.result=='ok') {
                        if (inicio) {
                            $("#selectorfechafin"+mid).val(data.fin);
                        }
                    } else {
                        if (!inicio) {
                            $("#selectorfechafin"+mid).val(data.fin);
                        }
                    }
                    $(".fechas"+mid).html("["+data.inicio+" al "+data.fin+"]");
                });
            });
            {% if error %}
                smoke.alert("{{ error }}");
            {% endif %}

            $(".correo").click(function(){
                $($("#horadescuentpanel").get(0).parentNode).find(".help-text").html("");
                materia = $(this).attr('idma');
                $("#horadescuentpanel #comment").val('');
                $("#horadescuentpanel #asunto").val('');
                $("#horadescuentpanel").show();
                $("#horadescuentpanel .paneltitle").html('Contenido a Enviar');
                $("#horadescuentpanel").modal({backdrop: 'static', keyboard: false, height:"100%"});
                return false;
            });

            $("#horadescuentpanel .btn-cerrar").click(function() {
                $("#horadescuentpanel").modal("hide");
                return false;
            });
            $("#horadescuentpanel .btn-adicionar").click(function() {
                adicionarhora(false);
                return false;
            });
            adicionarhora = function(cerrar) {
                var comentario = ($("#horadescuentpanel #comment").val())
                var asunto =  ($("#horadescuentpanel #asunto").val())
                if (comentario != '' && materia != 0 && asunto != ''){
                        $.post("/pro_cronograma", {"action":'correomasivo', "contenido":comentario,"idmat":materia,"asunto":asunto}, function(data) {
                                    if (data.result=='ok') {
                                        $("#horadescuentpanel").modal("hide");
                                        smoke.alert('El correo ha sido enviado correctamente')
                                    }
                                    else{
                                           $("#horadescuentpanel").modal("hide");
                                            smoke.alert('Error al enviar el correo')
                                    }

                        }, "json");

                        if (cerrar) {
                            $("#pagopanel").modal("hide");
                        }

                }
                else {
                    $($("#horadescuentpanel").get(0).parentNode).find(".help-text").html("<h4 class='alert alert-danger'>Ingresar Asunto y Contenido</h4>");
                }

            };
            $("#comment").blur(function(){
                var comentario =  $("#comment").val();
                if (comentario != ''){
                    $($("#horadescuentpanel").get(0).parentNode).find(".help-text").html("");
                }
            });
            $("#asunto").blur(function(){
                var asunto =  $("#asunto").val();
                if (asunto != ''){
                    $($("#horadescuentpanel").get(0).parentNode).find(".help-text").html("");
                }
            });

            aceptar = function(id,idprofesor,idmateria,tipolog,segmento) {
                $("#"+id).hide();
                segmentomateria=segmento;
                $("#idmateria").val(idmateria);
                $("#idprofesor").val(idprofesor);
                $("#tipolog").val(tipolog);
                $("#idprosmateria").val(id);

                $($("#id_idzoom").get(0).parentNode).find(".help-text").html("");
                $($("#id_material").get(0).parentNode).find(".help-text").html("");
                $($("#id_bancopregunta").get(0).parentNode).find(".help-text").html("");

                if (segmentomateria == 2){
                    $("#id_idzoom").attr("disabled",true);
                }
                else{
                    $("#id_idzoom").attr("disabled",false);
                }

                $("#archivopanel").modal({"backdrop":"static","width":"750px"});
                $("#archivopanel").modal("show");

            }

           $("#archivopanel .btn-cerrar").click(function(){
                $("#archivopanel").modal("hide");
                location.reload();
                return false;
           });

           function validarDatos(){
                 var r=0;
                 var idzoom =  $("#id_idzoom").val();

                $($("#id_idzoom").get(0).parentNode).find(".help-text").html("");
                $($("#id_material").get(0).parentNode).find(".help-text").html("");
                $($("#id_bancopregunta").get(0).parentNode).find(".help-text").html("");

                 var x = document.getElementById("id_material");
                 var fileExt = x.value;

                  var x2 = document.getElementById("id_bancopregunta");
                  var fileExt2 = x2.value;
                  var validExts = new Array(".pdf");

                  fileExt = fileExt.substring(fileExt.lastIndexOf('.'));
                  fileExt2 = fileExt2.substring(fileExt2.lastIndexOf('.'));
                if (validExts.indexOf(fileExt) < 0) {
                              x.value="";
                              $($("#id_material").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >Debe seleccionar el archivo</h6>");
                              r=1;
                }

                if (validExts.indexOf(fileExt2) < 0) {
                              x2.value="";
                              $($("#id_bancopregunta").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >Debe seleccionar el archivo</h6>");
                              r=1;
                }

{#                if (segmentomateria==1){#}
{#                    if (idzoom == ''){#}
{#                         $($("#id_idzoom").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >Debe Ingresar el Zoom ID</h6>");#}
{#                         r=1;#}
{#                    }#}
{#                }#}


                return r;

            }

            $("#formbuttonarchivo").click(function() {



                var form1= document.getElementById("id_material");
                var file1 = form1.files[0];

                var form2= document.getElementById("id_bancopregunta");
                var file2 = form2.files[0];

                var formData = new FormData();
                formData.append('action','aceptarrechazarmateria');
                if (file1){
                    formData.append('material',file1);
                }
                if (file2){
                    formData.append('bancopregunta',file2);
                }


                formData.append('idmateria',$("#idmateria").val());
                formData.append('idprofesor',$("#idprofesor").val());
                formData.append('tipolog',$("#tipolog").val());
                formData.append('idprosmateria',$("#idprosmateria").val());
                formData.append('comentario',$("#id_comentario").val());
                formData.append('idzoom',$("#id_idzoom").val());


                $.unblockUI();

                if (validarDatos()==0){
                       $("#archivopanel").modal("hide");
                       $.ajax({
                           url:'/pro_cronograma',
                           type:"POST",
                           contentType:false,
                           data:formData,
                           processData:false,
                           cache:false,
                           success: function(data)
                              {
                                   if(data.result=="ok") {

                                       smoke.alert("Se ingreso correctamente");

                                   }else{
                                       smoke.alert(data.mensaje);
                                       $("#archivopanel").modal("hide");
                                   }
                                     setInterval(function(){
                                                    location.reload();
                                                }, 5000);

                              }
                       });
                }


           });


            var validos = " abcdefghijklmnopqrstuvwxyz0123456789-_%,";

           function soloLetrasYNum(campo) {
               var letra;
               var bien = true;
               for (var i=0; i<campo.length; i++) {
                letra=campo.charAt(i).toLowerCase()
                if (validos.indexOf(letra) == -1){bien=false;};
               }
               if (!bien) {
                return 1;

               }else{
                 return 0;
               }
            }

            $("#archivopanel #id_material").change(function(){

                var x = document.getElementById("id_material");
                var fileExt = x.value;
                var validExts = new Array(".pdf");
                var fileExt1 = fileExt.substring(fileExt.lastIndexOf('.'));
                var nombre= fileExt.substring(fileExt.indexOf(x.files[0].name),fileExt.lastIndexOf('.'));
                if (parseInt(soloLetrasYNum(nombre))==1){
                    $("#archivopanel #id_material").val('');
                    $($("#archivopanel #id_material").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El Nombre del Archivo contiene Tilde, espacios en blanco o Caracteres Especiales</h6>");
                }else if (validExts.indexOf(fileExt1) < 0){
                    $("#archivopanel #id_material").val('');
                    $($("#archivopanel #id_material").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El formato del archivo solo debe ser PDF</h6>");
                }else{
                    $($("#archivopanel #id_material").get(0).parentNode).find(".help-text").html("");
                }
            });


              $("#archivopanel #id_bancopregunta").change(function(){

                var x = document.getElementById("id_bancopregunta");
                var fileExt = x.value;
                var validExts = new Array(".pdf");
                var fileExt1 = fileExt.substring(fileExt.lastIndexOf('.'));
                var nombre= fileExt.substring(fileExt.indexOf(x.files[0].name),fileExt.lastIndexOf('.'));
                if (parseInt(soloLetrasYNum(nombre))==1){
                    $("#archivopanel #id_bancopregunta").val('');
                    $($("#archivopanel #id_bancopregunta").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El Nombre del Archivo contiene Tilde, espacios en blanco o Caracteres Especiales</h6>");
                }else if (validExts.indexOf(fileExt1) < 0){
                    $("#archivopanel #id_bancopregunta").val('');
                    $($("#archivopanel #id_bancopregunta").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El formato del archivo solo debe ser PDF</h6>");
                }else{
                    $($("#archivopanel #id_bancopregunta").get(0).parentNode).find(".help-text").html("");
                }
              });


            $("#editararchivopanel #id_materialeditar").change(function(){

                var x = document.getElementById("id_materialeditar");
                var fileExt = x.value;
                var validExts = new Array(".pdf");
                var fileExt1 = fileExt.substring(fileExt.lastIndexOf('.'));
                var nombre= fileExt.substring(fileExt.indexOf(x.files[0].name),fileExt.lastIndexOf('.'));
                if (parseInt(soloLetrasYNum(nombre))==1){
                    $("#editararchivopanel #id_materialeditar").val('');
                    $($("#editararchivopanel #id_materialeditar").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El Nombre del Archivo contiene Tilde, espacios en blanco o Caracteres Especiales</h6>");
                }else if (validExts.indexOf(fileExt1) < 0){
                    $("#editararchivopanel #id_materialeditar").val('');
                    $($("#editararchivopanel #id_materialeditar").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El formato del archivo solo debe ser PDF</h6>");
                }else{
                    $($("#editararchivopanel #id_materialeditar").get(0).parentNode).find(".help-text").html("");
                }
            });


              $("#editararchivopanel #id_bancopreguntaeditar").change(function(){

                var x = document.getElementById("id_bancopreguntaeditar");
                var fileExt = x.value;
                var validExts = new Array(".pdf");
                var fileExt1 = fileExt.substring(fileExt.lastIndexOf('.'));
                var nombre= fileExt.substring(fileExt.indexOf(x.files[0].name),fileExt.lastIndexOf('.'));
                if (parseInt(soloLetrasYNum(nombre))==1){
                    $("#editararchivopanel #id_bancopreguntaeditar").val('');
                    $($("#editararchivopanel #id_bancopreguntaeditar").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El Nombre del Archivo contiene Tilde, espacios en blanco o Caracteres Especiales</h6>");
                }else if (validExts.indexOf(fileExt1) < 0){
                    $("#editararchivopanel #id_bancopreguntaeditar").val('');
                    $($("#editararchivopanel #id_bancopreguntaeditar").get(0).parentNode).find(".help-text").html("<h6 style='color:red' >El formato del archivo solo debe ser PDF</h6>");
                }else{
                    $($("#editararchivopanel #id_bancopreguntaeditar").get(0).parentNode).find(".help-text").html("");
                }
              });




               $("#formbuttoneditararchivo").click(function() {



                var form1= document.getElementById("id_materialeditar");
                var file1 = form1.files[0];

                var form2= document.getElementById("id_bancopreguntaeditar");
                var file2 = form2.files[0];

                var formData = new FormData();
                formData.append('action','editarmaterialdocente');
                if (file1){
                    formData.append('materialeditar',file1);
                }
                if (file2){
                    formData.append('bancopreguntaeditar',file2);
                }


                formData.append('idprofesormateriaid',$("#idprofesormateriaid").val());
                formData.append('idmateriaedit',$("#idmateriaedit").val());
                formData.append('idprofesoredit',$("#idprofesoredit").val());


                $.unblockUI();


                       $("#editararchivopanel").modal("hide");
                       $.ajax({
                           url:'/pro_cronograma',
                           type:"POST",
                           contentType:false,
                           data:formData,
                           processData:false,
                           cache:false,
                           success: function(data)
                              {
                                   if(data.result=="ok") {

                                       smoke.alert("Se edito correctamente correctamente");

                                   }else{
                                       smoke.alert(data.mensaje);
                                       $("#archivopanel").modal("hide");
                                   }
                                     setInterval(function(){
                                                    location.reload();
                                                }, 5000);

                              }
                       });



           });



           verarchivosubido = function(id,idprofesor,idmateria) {

             $.get("/pro_cronograma", {'action':'detallearch', "id":id,"idprofesor":idprofesor,"idmateria":idmateria}, function(data) {
                    $("#detalle_archivo .modal-body").html(data);
                    $("#detalle_archivo").modal({"backdrop":"static",width:'40%'});
                    $("#detalle_archivo").modal("show");
                   }, "html");
                   return false;
           }


           $("#detalle_archivo .btn-cerrar").click(function(){
                $("#detalle_archivo").modal("hide");

                return false;
           });

           $("#editararchivopanel .btn-cerrar").click(function(){
                $("#editararchivopanel").modal("hide");

                return false;
           });



           rechazado = function(id,idprofesor,idmateria,tipolog) {
                $("#"+id).hide();

                smoke.prompt("Ingrese Observaci&oacute;n", function(v) {
                            if (v) {
                               $.post("/pro_cronograma", {"action":'rechazarmateria', "id":id,"idprofesor":idprofesor,"idmateria":idmateria,"tipolog":tipolog,"comentario":v.toUpperCase()}, function(data) {
                                        if (data.result=='ok') {
                                            smoke.alert('Se ingreso correctamente ');
                                            setInterval(function(){
                                                location.reload();
                                            }, 5000);


                                        }
                                        else{

                                            if (parseInt(data.fechamayor)==1){
                                                smoke.alert('La fecha es mayor a la fecha de finalización de la materia ');
                                            }else{
                                                if (parseInt(data.fechamayor)==3){
                                                    smoke.alert('No puede rechazar la materia porque tiene clase iniciada ');
                                                }else{
                                                    smoke.alert('No se ingreso correctamente ');
                                                }
                                            }

                                            setInterval(function(){
                                                location.reload();
                                            }, 5000);
                                        }

                               }, "json");
                            } else {
                                $("#"+id).show();
                            }
                        });

            }

            $("#idzoom").addClass('input-large');
            $('.agregar_zoom').click(function(){
                $("#idzoom").val('');
                $("#id").val($(this).attr('id'));
                $("#agregar_zoom #paneltitle2").html('Agregar Zoom ID');
                $("#agregar_zoom").modal({"backdrop":"static","width":"500px"});
                $("#agregar_zoom").modal("show");
            });

            $('.modificar_zoom').click(function(){
                $("#idzoom").val($(this).attr('idzoom'));
                $("#id").val($(this).attr('id'));
                $("#agregar_zoom #paneltitle2").html('Modificar Zoom ID');
                $("#agregar_zoom").modal({"backdrop":"static","width":"500px"});
                $("#agregar_zoom").modal("show");
            });

            $("#agregar_zoom .btn-cerrar").click(function(){
                $(".formError").removeClass('aparece');
                $(".formError").addClass('oculta');
                $("#agregar_zoom").modal("hide");
                return false;
            });

            $("#formbutton_idzoom").click(function(){
                $(".formError").removeClass('oculta');
                $(".formError").addClass('aparece');
            });




        });
    </script>
    <style>
        .oculta{
            display: none;
        }
        .aparece{
            display: block;
        }
    </style>
{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span11'>
            <h3>Cronograma de Materias del Profesor : {{ profesor }} </h3>
            <h5>Per&iacute;odo: {{ periodo }} </h5><br>
        </div>
        <div class='span1'>
            <a href="/" class='btn'><i class="icon-arrow-left"></i> Atr&aacute;s</a>
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span12'>
            <a href="/reportes?action=run&direct=true&n=mate_cronogramaprofesor&profesor={{ profesor.id }}&periodo={{ periodo.id }}&rt=pdf" class='btn'><i class="icon-print"></i> Imprimir</a>
            {% if not persona.pertenece_soporte %}
                <a href="/pro_horarios?action=horariobs" class='btn btn-success'><i class="icon-time"></i> Ir al Horario</a>
            {% endif %}
        </div>
    </div>
    <br>
    <div class='row-fluid'>
        <div class='span12'>
            <table class='table table-bordered table-striped' cellpadding="0" cellspacing="0">
                <thead>
                <tr>
                    <th>Asignatura</th>
                    {% if UTILIZA_ASIGNATURA_RECTORA %}
                        <th>Rectora</th>
                    {% endif %}
                    <th>Nivel {% if not materia.nivel.carrera %}/ Coordinacion{% else %}/ Paralelo / Carrera {% endif %}</th>
                    <th>Inicia / Termina</th>
                    <th>Horas / Cr&eacute;ditos</th>
                    <th>Profesor(es)</th>
                    <th>Horarios</th>
                    <th>Periodo</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                {% for materia in materias %}
                    {%  if materia.aprobada or not VALIDA_MATERIA_APROBADA %}
                        <tr>
                        <td>{% if materia.identificacion %}{{ materia.identificacion }}{% else %}###{% endif %}-{{ materia.asignatura }}<br>
                            {% for profesormateria in materia.profesores_materia %}
                                {% if profesormateria.idzoom %}
                                    {% if not persona.pertenece_soporte %}
                                        <a href="#" class="modificar_zoom" id="{{ profesormateria.id }}" idzoom='{{ profesormateria.idzoom }}'><span class="icon-edit"></span> ZOOM ID: {{ profesormateria.idzoom }}</a>
                                        <br/>{% if profesormateria.documentaciondiscapacidad %}<b><span style="color: red"> Informe de discapacidad enviado al correo </span></b>{% endif %}
                                    {% else %}
                                        <a><span class="icon-edit"></span> ZOOM ID: {{ profesormateria.idzoom }}</a>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}

{#                        <br>#}
{#                         {% if  materia.exordinario %}<span class="label label-important"> Ex. Ordinario {{  materia.exordinario|date:"d-m-Y" }} {% endif %} {% if   materia.revision  %} Revisi&oacute;n  {{  materia.revision|date:"d-m-Y" }} {% endif %} {% if  materia.exatrasado %} Ex. Atrasado {{  materia.exatrasado|date:"d-m-Y" }}{% endif %}</span>#}
                        </td>
                        {% if UTILIZA_ASIGNATURA_RECTORA %}
                            <td>{% if materia.rectora %}<img src='/static/images/16/true.png' alt=''/>{% else %}-{% endif %}</td>
                        {% endif %}
                        <td> {% if materia.nivel.nivelmalla %} {{ materia.nivel.nivelmalla }}{% else %} {{ materia.nivel }}{% endif %} {% if materia.nivel.grupo %}/ {{ materia.nivel.grupo.nombre }} {% endif %} <br/> {% if  materia.nivel.carrera %} {{ materia.nivel.carrera }} {% else %} {{ materia.nivel.coordinacion.nombre }}{% endif %}
                             <br/>{% if materia.nivel.tutornivel %}<b><span style="color: #0000ff"> Tutor: {{ materia.nivel.tutornivel.tutor.persona.nombre_completo_inverso }}</span></b>{% endif %}
                        </td>
                        <td><span class="label"> {{ materia.inicio|date:'d-m-Y' }} </span> <br/><br/>
                        <span class="label"> {{ materia.fin|date:'d-m-Y' }} </span></td>
                        <td>{{ materia.horas }} Horas <br/> {{ materia.creditos }} Cr&eacute;ditos</td>
                        <td>
                            <table class="table table-bordered table-condensed">
                                {% if materia.profesormateria_set.count %}
                                    {% for profesormateria in materia.profesores_materia %}
                                                                               {% if  profesormateria.fechacorreo %}
                                        <tr>
                                            <td>  {{ profesormateria.segmento }}  - <b> {{ profesormateria.profesor.persona.nombre_completo }}</b>  {%  if profesormateria.profesor_aux %} <span class="label label-info">Aux. </span> <b>  {{ profesormateria.profesor_auxiliar.persona.nombre_completo }} </b> {% endif %} [{{ profesormateria.desde|date:'d-m-Y' }} al {{ profesormateria.hasta|date:'d-m-Y' }}] {% if forloop.first and materia.profesores_materia.count > 1 %}<span class="label label-success">PRINCIPAL</span>{% endif %}
                                            {% if profesormateria.tiene_log_profesor  %}
                                                <br>  {% if  profesormateria.log_profesor.tipolog == 1 %}<span class="label label-success">Aceptado el {{ profesormateria.log_profesor.fechaceptacion|date:'d-m-Y' }} </span> {% else %} <span class="label label-important">Rechazado el {{ profesormateria.log_profesor.fechaceptacion|date:'d-m-Y' }} </span> {% endif %}
                                                <br>  {% if  profesormateria.tiene_materialsubido %}
                                                        {% if not persona.pertenece_soporte %}
                                                            <a class="label label-success" href="#" onclick="verarchivosubido('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',1)"><span > Material Subido </span></a>
                                                        {% else %}
                                                            <a class="label label-success"><span > Material Subido </span></a>
                                                        {% endif %}
                                                      {% endif %}
                                             {% endif %}
                                            </td>
                                        </tr>
                                        {% if DEFAULT_PASSWORD == 'itb' %}
                                            {% if not persona.pertenece_soporte %}
                                                <tr>
                                                    <td>


                                                       {% if profesormateria.profesor_logaceptacion and not profesormateria.aceptar_suspension %}
                                                            {% if not profesormateria.aceptacion %}
                                                                   {% if  profesormateria.profesor_aux > 0 %}
                                                                       {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                            <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                       {% endif %}
                                                                   {% else %}

                                                                       {% if  profesormateria.profesor.id == profesor.id  %}
                                                                            <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                       {% endif %}
                                                                   {% endif %}

                                                            {% else %}
                                                                {% if profesormateria.profesor_aux > 0 %}
                                                                    {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                        <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                    {% endif %}
                                                                {% else %}
                                                                    {% if  profesormateria.profesor.id == profesor.id  %}
                                                                        <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                    {% endif %}
                                                                {% endif %}

                                                            {% endif %}
                                                       {% else %}
                                                           {% if profesormateria.profesor_logaceptacion %}
                                                               {% if profesormateria.tiene_log_quitar_profesor %}
                                                                      {% if not profesormateria.aceptar_suspension %}
                                                                           {% if not profesormateria.aceptacion %}
                                                                               {% if  profesormateria.profesor_aux > 0 %}
                                                                                   {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                                        <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                                   {% endif %}
                                                                               {% else %}

                                                                                   {% if  profesormateria.profesor.id == profesor.id  %}
                                                                                        <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                                   {% endif %}
                                                                               {% endif %}

                                                                           {% else %}
                                                                                {% if profesormateria.profesor_aux > 0 %}
                                                                                    {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                                        <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                                    {% endif %}
                                                                                {% else %}
                                                                                    {% if  profesormateria.profesor.id == profesor.id  %}
                                                                                        <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                                    {% endif %}
                                                                                {% endif %}

                                                                           {% endif %}



                                                                      {% endif %}


                                                               {% else %}


                                                                   {% if not profesormateria.aceptacion %}
                                                                               {% if  profesormateria.profesor_aux > 0 %}
                                                                                   {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                                        <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                                   {% endif %}
                                                                               {% else %}

                                                                                   {% if  profesormateria.profesor.id == profesor.id  %}
                                                                                        <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                                   {% endif %}
                                                                               {% endif %}

                                                                   {% else %}
                                                                        {% if profesormateria.profesor_aux > 0 %}
                                                                            {% if  profesormateria.profesor_aux == profesor.id   %}
                                                                                <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                            {% endif %}
                                                                        {% else %}
                                                                            {% if  profesormateria.profesor.id == profesor.id  %}
                                                                                <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                            {% endif %}
                                                                        {% endif %}

                                                                   {% endif %}



                                                               {% endif %}



                                                           {% else %}

                                                               {% if  profesormateria.profesor_aux > 0 %}
                                                                   {% if  profesormateria.profesor_aux == profesor.id   %}

                                                                     <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                     <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor_aux }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                   {% endif %}
                                                               {% else %}
                                                                     {% if  profesormateria.profesor.id == profesor.id  %}
                                                                      <a class="btn btn-success" href="#" id='{{ profesormateria.id  }}' onclick="aceptar('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',1,'{{ profesormateria.segmento.id }}')" title="Aceptar la Materia"  style="color:rgb(255, 255, 255);">ACEPTAR </a>
                                                                      <a class="btn btn-danger" href="#" id='{{ profesormateria.id  }}' onclick="rechazado('{{profesormateria.id }}','{{ profesormateria.profesor.id }}','{{ profesormateria.materia.id }}',2)" title="Rechazar la Materia" style="color:rgb(255, 255, 255);">NO ACEPTAR </a>
                                                                     {% endif %}
                                                               {% endif %}

                                                           {% endif %}


                                                       {% endif %}




                                                    </td>
                                                </tr>
                                            {% endif %}
                                         {% endif %}
                                        {% endif %}
                                    {% endfor %}

                               {% endif %}
                            </table>

                        </td>

                        <td>
                            <ol>
                                {% for clase in materia.clase_set.all %}
                                <li>{{ clase.dia_semana }} - ({{ clase.turno.comienza }} a {{ clase.turno.termina }})
                                    {% if clase.virtual %}
                                        <b style="color: red">  CLASE VIRTUAL </b>
                                    {% else %}
                                         {% if clase.aula.nombre %} Aula: {{ clase.aula.nombre }} {%  endif %}
                                {%  endif %}
                                </li>

                                {% endfor %}
                            </ol>
                        </td>
                        <td>{{ materia.nivel.periodo }}</td>

                        <td>
                            <div class="btn-group">
                                <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
                                    Acciones
                                    <span class="caret"></span>
                                </a>
                                    <ul class="dropdown-menu pull-right">
                                    <li><a href="/reportes?action=run&direct=true&n=listado_asistencia_dias&materia={{ materia.id }}&rt=pdf"><span class="icon-print"></span> Imprimir Listado de Asistencia</a> </li>
                                    <li><a href="/reportes?action=run&direct=true&n=lista_alumnos_matriculados_materia&materia={{ materia.id }}&rt=pdf"><span class="icon-print"></span> Imprimir Listado de Matriculados</a> </li>
                                    {% if not persona.pertenece_soporte %}
                                        <li><a href="" class="correo" idma="{{ materia.id }}"><span class="icon-file"></span> Enviar Correo Masivo</a> </li>
                                        <li><a href="/pro_cronograma?action=online&idma={{ materia.id }}"><span class="icon-cloud"></span> Clases Online </a> </li>
                                        {% for profesormateria in materia.profesores_materia %}
                                            {% if profesormateria.idzoom and profesormateria.log_profesor.tipolog == 1%}
                                                    <li><a href="#" class="modificar_zoom" id="{{ profesormateria.id }}" idzoom='{{ profesormateria.idzoom }}'><span class="icon-edit"></span> Modificar Zoom ID</a></li>
                                                    <li><a href="https://us04web.zoom.us/j/{{ profesormateria.idzoom }}" target="_blank"><span class="icon-share-alt"></span> Iniciar Zoom</a></li>
                                            {% else %}
                                                {% if  profesormateria.log_profesor.tipolog == 1 %}
                                                    <li><a href="#" class="agregar_zoom" id="{{ profesormateria.id }}"><span class="icon-plus"></span> Agregar Zoom ID</a></li>
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                    {% endif %}
                                </ul>
                            </div>
                        </td>
                    </tr>
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span12'>
            <a href="/reportes?action=run&direct=true&n=mate_cronogramaprofesor&profesor={{ profesor.id }}&periodo={{ periodo.id }}&rt=pdf" class='btn'><i class="icon-print"></i> Imprimir</a>
            {% if not persona.pertenece_soporte %}
                <a href="/pro_horarios?action=horariobs" class='btn btn-success'><i class="icon-time"></i> Ir al Horario</a>
            {% endif %}
        </div>
    </div>
    <div class="modal fade static" id="horadescuentpanel" style="display: none;">
        <div class="modal-header">
            <h4>Asunto:<textarea name="asunto" id="asunto"  rows="1" tabindex="4" style="text-transform: none;width: 100%"></textarea></h4>

        </div>
        <div class="modal-body panelbody" style="height:100%">
            <form id="formulario3" class='form-vertical' action="" method="POST" style="height:100%">
                <fieldset class="control-group nomargins">
                    <div class="controls">
                        <h4>Contenido:<textarea name="comment" id="comment" cols="100%" rows="18" tabindex="4" style="text-transform: none"></textarea></h4>

                        <p class="help-text"> </p>
                    </div>
                </fieldset>
            </form>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-adicionar btn-inverse" style="background: #49afcd">Enviar</a>
            <a href="#" class="btn btn-cerrar">Cerrar</a>
        </div>
     </div>


    <div class="modal fade static" id="c" style="display: none;">
        <div class="modal-header">
            <h4>Asunto:<textarea name="asunto" id="asunto"  rows="1" tabindex="4" style="text-transform: none;width: 100%"></textarea></h4>

        </div>
        <div class="modal-body panelbody" style="height:100%">
            <form id="formulario3" class='form-vertical' action="" method="POST" style="height:100%">
                <fieldset class="control-group nomargins">
                    <div class="controls">
                        <h4>Contenido:<textarea name="comment" id="comment" cols="100%" rows="18" tabindex="4" style="text-transform: none"></textarea></h4>

                        <p class="help-text"> </p>
                    </div>
                </fieldset>
            </form>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-adicionar btn-inverse" style="background: #49afcd">Enviar</a>
            <a href="#" class="btn btn-cerrar">Cerrar</a>
        </div>
     </div>

    <div class="modal fade static" id="agregar_zoom">
        <div class="modal-header " style="word-wrap: break-word">
            <h4  id='paneltitle2' ></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/pro_cronograma" method="POST"  >
                <input type='hidden' name='action' value='add_idzoom' />
                <input type='hidden' name='id' id='id' />
                <label for="id_zoom">Zoom ID: </label>
                <input type='text' name='idzoom' id='idzoom'/>
                <br><br>
                <button type="submit" class="btn btn-success" id="formbutton_idzoom">Guardar</button>
                <a href="#" class="btn btn-cerrar"> Cerrar</a>
            </form>
        </div>
    </div>

    <div class="modal fade static" id="archivopanel">
        <div class="row-fluid modal-header">
            <h4  id='paneltitle2'><i> Ingrese Archivo </i></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto" class='well form-horizontal'   method="POST"   >
                <input type='hidden' name='idprosmateria' id='idprosmateria' />
                <input type='hidden' name='idmateria' id='idmateria' />
                <input type='hidden' name='idprofesor' id='idprofesor'  />
                <input type='hidden' name='tipolog' id='tipolog'  />
                {% for field in formMaterialDocente %}
                    <fieldset class="control-group nomargins">
                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>
                        <div class="controls">
                            {{ field }}
                            <p class="help-text">{{ field.help_text }} </p>
                        </div>
                    </fieldset>
                {% endfor %}
                <a href="#" class="btn btn-success" id="formbuttonarchivo">Guardar</a>

                <a href="#" class="btn btn-cerrar"> Cerrar</a>

            </form>
        </div>
    </div>

    <div class="modal fade static " id="detalle_archivo" style="margin-left: -500"  >
        <div class="modal-header" style="text-align: center;word-wrap: break-word">
            <h4  id="paneltitle"><i> Ver Archivos Subidos </i></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >

        </div>
        <div class="modal-footer">
            <div style="float: right">
                <a href="#" id="cerrar" class="btn btn-cerrar  btn-aceptar">Cerrar</a>
            </div>
        </div>
    </div>


    <div class="modal fade static" id="editararchivopanel">
        <div class="row-fluid modal-header">
            <h4  id='paneltitle2'><i> Editar Archivo </i></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal'  method="POST"   >
               <input type='hidden' name='action' value='editarmaterialdocente' />
                <input type='hidden' name='idprofesormateriaid' id='idprofesormateriaid' />
                <input type='hidden' name='idmateriaedit' id='idmateriaedit' />
                <input type='hidden' name='idprofesoredit' id='idprofesoredit'  />
                {% for field in MaterialDocenteEditarForm %}
                    <fieldset class="control-group nomargins">
                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>
                        <div class="controls">
                            {{ field }}
                            <p class="help-text">{{ field.help_text }} </p>
                        </div>
                    </fieldset>
                {% endfor %}
                <a href="#" class="btn btn-success" id="formbuttoneditararchivo">Guardar</a>

                <a href="#" class="btn btn-cerrar"> Cerrar</a>

            </form>
        </div>
    </div>


{% endblock %}