{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script src='/static/js/jquery.validationEngine.js' type="text/javascript"></script>
    <script src='/static/js/jquery.validationEngine-es.js' type="text/javascript"></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css"/>
    <script type="text/javascript">

        $(function() {



            var openedWindow="";

            $('.gestion').click(function(e) {
                consultaresp = false;
                $("#finaliza").show();
                $("#bfinaliza").show();
                $("#requerimiento").val("");
                $("#prequerimiento").html("");
                $("#id_archivo").val("");
                $("#nuevopanel #action").val("addgestion");
                $("#idrequeri").val($(this).attr('idreq'));
                $("#nuevopanel").modal({width: '40%', backdrop: 'static'});
                $("#nuevopanel").modal("show");
            });

            $('#nuevopanel #firmcerrar').click(function(e) {
                if(consultaresp){
                    modalgestionresp();
                }
                $("#requerimiento").val("");
                $("#prequerimiento").html("");
                $("#id_archivo").val("");
                $("#nuevopanel").modal("hide");
                return false;
            });

            $('#nuevopanel #ingresarfirm').click(function(e) {
                var valida = true;
                $('#nuevopanel #ingresarfirm').hide();
                var inputFileImage = document.getElementById("id_archivo");
                var file = inputFileImage.files[0];
                if($.trim($("#requerimiento").val()) == ""){
                    valida = false
                    $("#prequerimiento").html("INGRESE LA GESTION")
                }

                if(valida){
                    var finaliza = false;
                    if(!consultaresp){
                        if($("#finaliza").is(':checked')) {
                            finaliza = true;
                        }
                    }else{
                         finaliza = true
                    }
                    inputFileImage = document.getElementById("id_archivo");
                    file = inputFileImage.files[0];
                    var data = new FormData();

                    data.append('archivo',file);
                    data.append('action',$("#nuevopanel #action").val());
                    data.append('requerimiento',$("#requerimiento").val());
                    data.append('finaliza',finaliza);
                    data.append('idrequeri',$("#idrequeri").val());
                    var url = "/soportetics";
                    showWaiting("Guardando informacion","Espere unos segundos por favor...");
                    $.ajax({
                    url:url,
                    type:"POST",
                    contentType:false,
                    data:data,
                    processData:false,
                    cache:false,
                    success: function(data)
                       {
                        if(data.result=="ok"){
                            $('#nuevopanel').modal('hide');
                            if(consultaresp){
                                modalgestionresp();
                            }else{
                                smoke.alert('Se ingreso la gesti√≥n con exito');
                                setInterval(function(){
                                    $.unblockUI();
                                    location.href="/soportetics";
                                }, 4000);
                            }
                        }
                        else{
                            $($("#id_archivo").get(0).parentNode).find(".help-textr").html("<h6 class='alert alert-danger'>Error Intentelo Nuevamente</h6>");
                        }
                        hideWaiting();
                       }
                    });
                    $('#nuevopanel #ingresarfirm').show();
                    return false;
                }
                else{
                    $('#nuevopanel #ingresarfirm').show();
                }
            });

{#            ///////////////////////////////////////////////////////////////////////////////////////#}
{#            ///////////////////////////////////////////////////////////////////////////////////////#}

            $("#inicio").blur(function(){

                var v = $("#inicio").val();
                var p = tiene_numeros(v);
                if(v!=''){
                    if (v.split(':').length == 2 ){
                        if (p != v.length | v.split(':')[0].length < 2 | v.split(':')[1].length < 2 | v.split(':').length > 2 | parseInt(v.split(':')[1])> 59)
                        {
                          $("#pinicio").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                          $("#inicio").focus();
                        }
                        else{
                            $("#pinicio").html("");

                        }
                    }
                    else{
                          $("#pinicio").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                          $("#inicio").focus();
                        }
                }
                else{
                    $("#pinicio").html("");
                }
            });

            $("#fin").blur(function(){

                var v = $("#fin").val();
                var p = tiene_numeros(v);
                if(v!=''){
                    if (v.split(':').length == 2 ){
                        if (p != v.length | v.split(':')[0].length < 2 | v.split(':')[1].length < 2 | v.split(':').length > 2 | parseInt(v.split(':')[1])> 59)
                        {
                          $("#pfin").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                          $("#fin").focus();
                        }
                        else{
                            $("#pfin").html("");

                        }
                    }
                    else{
                          $("#pfin").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                          $("#fin").focus();
                        }
                }
                else{
                    $("#pfin").html("");
                }
            });

            var numeroshor="0123456789:";

            function tiene_numeros(texto){
               var num = 0;
               for(i=0; i<texto.length; i++){
                  if (numeroshor.indexOf(texto.charAt(i),0)!=-1){
                      num = num +1;
                  }
               }
               return num;
            }

            $(".editturno").click(function(){
                $("#horaasistente").modal({backdrop: 'static', keyboard: false,width: "25%"});
                $("#horaasistente").modal("show");
                {% if horarioasistente.requeexiste  %}
                    {% if not asistente2 %}
                        $("#sede").hide();
                        $("#bsede").hide();
                        $("#binicio").hide();
                        $("#inicio").hide();
                    {% endif %}
                {% else %}
                    $("#sede").show();
                    $("#bsede").show();
                    $("#binicio").show();
                    $("#inicio").show();
                {% endif %}
            });

            $("#cerrarmodal").click(function(){
               location.reload();
            });

            $(".vergestion").click(function(){
               consultaresp = false;
               $("#bfinaliza").hide();
               $("#finaliza").hide();
               idrequerimiento = $(this).attr('idreq');
               $("#paneltitle2").html($(this).attr('req'));
               acctionmod = 'vergestion';
               modalgestionresp();

            });

            modalgestionresp = function(){
               $.get("/soportetics", {'action':acctionmod, 'idreq': idrequerimiento}, function(data) {
                    $("#vergestionpanel .modal-body").html(data);
                    $("#vergestionpanel").modal({"backdrop":"static","width":"70%"});
                    $("#vergestionpanel").modal("show");
               }, "html");
            };

            $("#vergestionpanel .btn-cerrar").click(function(){
                $("#vergestionpanel").modal("hide");
                location.reload();
                return false;
            });

            $("#nolabora").click(function(){
                $("#pinicio").html('');
                $("#pfin").html('');
                $("#psede").html('');
                $("#pnolabora").html("");

                if ($("#nolabora").is(':checked')) {
                    $("#inicio").val('');
                    $("#sede").val(-1);
                    $("#sede").attr('disabled',true);
                    $("#inicio").attr('readonly',true);
                    $("#fin").val('');
                    $("#fin").attr('readonly',true);
                }else{
                    $("#sede").attr('disabled',false);
                    $("#inicio").attr('readonly',false);
                    $("#fin").attr('readonly',false);
                }

            });
            $("#ingresarhorsop").click(function(){
                $("#pinicio").html("");
                $("#pfin").html("");
                $("#psede").html("");
                $("#pnolabora").html("");
                var valida = true;
                var nolabora = true;
                if (!$("#nolabora").is(':checked')) {
                    nolabora = false;
                    if($("#inicio").val()==''){
                        $("#pinicio").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                        valida = false
                    }
                    if($("#fin").val()==''){
                        $("#pfin").html("Ingresar solo  Numeros, Recuerde el formato es 00:00 y los minutos deben ser  menor a 60");
                        valida = false
                    }
                    if($("#sede").val()== -1 ){
                        $("#psede").html("Escoja una opcion");
                        valida = false
                    }
                }
                if(valida){
                    showWaiting("Guardando informacion","Espere unos segundos por favor...");
                    $.post("/soportetics", {"action":'editturno', "idhorat":'{{ horarioasistente.id }}', "sede":$("#sede").val(), "hinicio":$("#inicio").val(), "hfin":$("#fin").val(), "nolabora":nolabora{% if asistente2 %},"asistente2":'{{ asistente2.soporte.id }}'{% endif %}}, function(data) {
                       if (data.result=='ok') {
                           $("#horaasistente").modal("hide");
                           smoke.alert('Registro ingresado');
                            setInterval(function(){
                                $.unblockUI();
                                location.href="/soportetics";
                            }, 3000);
                       }else{
                           $("#pmensja").html("Error Vuelva a Intentarlo");
                       }
                    }, "json");
                    hideWaiting();
                }
            });
            {% if info %}
                smoke.alert('{{ info }}');
            {% endif %}

            var idreareqhorar = 0;
            $(".reasignar").click(function(){
                idreareqhorar = $(this).attr("idreq");
                $("#preasigsoport").html("");
                $("#panrequer").html($(this).attr("req"));
                $("#reasiganarmod").modal({backdrop: 'static', keyboard: false,width: "35%"});
                $("#reasiganarmod").modal("show");
            });
            $("#cerreasign").click(function(){
                $("#reasiganarmod").modal("hide");
            });


            $("#ingresreasigsop").click(function(){
                $("#preasigsoport").html("");
                var valida = true;
                if($("#reasigsoport").val()== 0){
                    $("#preasigsoport").html("Escoja una opcion");
                    valida = false
                }

                var combo = document.getElementById('reasigsoport');
                var progravar = 'False';
                if(($('#reasigsoport option').eq(combo.selectedIndex).attr('progra')) == 'True'){
                    progravar = 'True';
                    if($.trim($("#consultareq").val())== ""){
                        $("#pconsultareq").html("Ingrese la consulta");
                        valida = false
                    }
                }
                if(valida){
                    showWaiting("Guardando informacion","Espere unos segundos por favor...");
                    $.post("/soportetics", {"action":'reasignar',"progravar":progravar, "idreareqhorar":idreareqhorar, "reasigsoport":$("#reasigsoport").val(), "consulta":$("#consultareq").val()}, function(data) {
                       if (data.result=='ok') {
                           $("#reasiganarmod").modal("hide");
                           smoke.alert('Registro ingresado');
                            setInterval(function(){
                                $.unblockUI();
                                location.href="/soportetics";
                            }, 4000);
                           hideWaiting();

                       }else{
                           $("#pmensja").html("Error Vuelva a Intentarlo");
                           hideWaiting();
                       }
                    }, "json");

                }
            });
            var consultaresp = false;
            var acctionmod = "";
            var idrequerimiento = 0;
            $(".consultresp").click(function(){
                consultaresp = true;
                $("#finaliza").hide();
                $("#bfinaliza").hide();
                idrequerimiento = $(this).attr('idreq');
                $("#paneltitle2").html($(this).attr('req'));
                acctionmod = 'verconsulta';
                modalgestionresp();

            });

            $("#reasigsoport").change(function(){
                var combo = document.getElementById('reasigsoport');
                if(($('#reasigsoport option').eq(combo.selectedIndex).attr('progra')) == 'True'){
                    $("#preasigsoport").html("");
                    $("#consultareq").show();
                    $("#bconsultareq").show();
                }else{
                    $("#preasigsoport").html("");
                    $("#consultareq").hide();
                    $("#bconsultareq").hide();
                }
            });

            $("#soporteasis").change(function(){
                if($("#soporteasis").val()>0){
                    location.href = "/soportetics{% if finali %}?finali=1{% endif %}{% if finali %}&{% else %}?{% endif %}idasis="+$("#soporteasis").val()
                }else{
                    location.href = "/soportetics?{% if finali %}?finali=1{% endif %}"
                }
            });


            $("#search").click(function() {
                var term = $("#searchfield").val().toUpperCase();
                if($.trim(term)!='') {
                    location.href = "/soportetics?s=" + term;
                }
            });

            $('#searchfield').keyup(function(e) {
                if(e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });


            $('#chprogra').change(function(e) {
                var html = "<option value='0'>-----</option>"
                if ($("#chprogra").is(':checked')) {
                    $.post("/soportetics", {"action":'datacombo'}, function(data) {
                       if (data.result=='ok') {
                           for (var o in data.list) {
                                 html=html+'<option  value="'+data.list[o].id+'" progra="'+data.list[o].progra+'"> '+data.list[o].nombre+'</option>';
                            }
                           $("#reasigsoport").html(html);
                       }else{
                           $("#pmensja").html("Error Vuelva a Intentarlo");
{#                           hideWaiting();#}
                       }
                    }, "json");
                }else{
                    $("#chprogra").attr('checked',false);
                    {% for s in soportehorarios %}
{#                        html = html +"<option value='{{ s.id }}' progra='{{ s.programador }}' >{{ s.soporte }}</option>"#}
{#                        # OCastillo 16-nov-2021 para presentar a personal de soporte asi no tengan horario ingresado#}
                        html = html +"<option value='{{ s.id }}' progra='{{ s.programador }}' >{{ s.persona.nombre_completo }}</option>"
                    {% endfor %}
                    $("#reasigsoport").html(html);
                }
            });

            {% if not verasistente %}
                $('#chprogra').change();
            {% endif %}
            ver = function(){
                var html='';
                var html1='';
                var general=false;
                var filtro = $("#fechatab").val();
                if ($("#general").is(':checked')) {
                    general=true
                    filtro = 'General';
                }

                showWaiting("Extrayendo datos","Espere unos segundos por favor...");
                $.post("/soportetics", {"action":'dataregistros','general':general,'fecha':$("#fechatab").val()}, function(data) {
                   if (data.result=='ok') {
                       for (var o in data.list) {
                           if(o < 6){
                               html = html + '<tr>'+
                                        '<td> <a class="label label-info">'+data.list[o].horaingre+'</a></td>'+
                                        '<td> <a class="label label-success">'+data.list[o].horarioactual+'</a></td>'+
                                        '<td>'+data.list[o].nombre+'</td>'+
                                        '<td><a class="label label-important">'+filtro+'</a></td>'+
                                        '<td>'+data.list[o].reg+'</td>'+
                                        '<td>'+data.list[o].sin+'</td>'+
                                        '<td>'+data.list[o].fin+'</td>'+
                                        '<td> <a class="label label-warning">'+data.list[o].tipo+'</a></td>'+
                                    '</tr>';
                           }else{
                               html1 = html1 + '<tr>'+
                                        '<td> <a class="label label-info">'+data.list[o].horaingre+'</a></td>'+
                                        '<td> <a class="label label-success">'+data.list[o].horarioactual+'</a></td>'+
                                        '<td>'+data.list[o].nombre+'</td>'+
                                        '<td><a class="label label-important">'+filtro+'</a></td>'+
                                        '<td>'+data.list[o].reg+'</td>'+
                                        '<td>'+data.list[o].sin+'</td>'+
                                        '<td>'+data.list[o].fin+'</td>'+
                                        '<td> <a class="label label-warning">'+data.list[o].tipo+'</a></td>'+
                                    '</tr>';
                           }
                        }
                       $("#bodytble1").html(html);
                       $("#bodytble2").html(html1);
                       if(html1 != ''){
                           $("#table2asis").show()
                       }

                       hideWaiting();
                   }else{

                       hideWaiting();
                       smoke.alert("Error Vuelva a Intentarlo");
{#                           hideWaiting();#}
                   }
                }, "json");
                $("#opchead").html('<a style="cursor: pointer" class="label label-important" id="ocultar" onclick="ocultar()"> Ocultar </a>')

            };
            ocultar = function(){
                $("#bodytble1").html('');
               $("#bodytble2").html('');
               $("#table2asis").hide();
                $("#opchead").html('<a style="cursor: pointer" class="label label-info" id="ver" onclick="ver()"> Ver </a>')
            };

            $("#general").click(function() {
                if ($("#general").is(':checked')) {
                    var html='';
                    $("#fechatab").attr('disabled',true)
                }
                else{
                    $("#fechatab").attr('disabled',false)
                }
                ver();
            });

            $('#fechatab').on('changeDate', function(ev){
                if (!$("#general").is(':checked')) {
                    ver();
                }
            });

            $("#fechatab").datepicker({format:'yyyy-mm-dd'}).mask("9999-99-99");


            verchat = function (){
                 {% if  persona.emailinst %}
                     window.open("https://sga.itb.edu.ec/soportetics?action=chatsoporte" , "popup" , 'top=10,left=100,width=1400,height=700,toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no');
                 {% else %}
                     smoke.alert('No tiene registrado el email del instituto ');
                 {% endif %}

             }

             {#---EDITAR VIDEO LOGIN----#}
            $('#editarvideologin').click(function() {
                $("#id_descripcion").val()
                {#$("#chactivo").val()#}
                $("#modalvideologin").modal({width: '20%', backdrop: 'static'});
                $("#modalvideologin").modal("show");
            });

            $('#modalvideologin .btn-cerrar').click(function() {
                $("#modalvideologin").modal("hide");
                return false;
            });
             $('#modalvideologin .btn-guardar').click(function() {
                 var valida = true
                 var idvideo = {{ videologin.id }}
                 var descripcion = $("#id_descripcion").val()
                 {# var activo= false;#}
                 {#if ($("#chactivo").is(':checked')){#}
                 {#      var activo = true;#}
                 {# } #}
                if(valida){
                    showWaiting("Guardando informacion","Espere unos segundos por favor...");
                    $.post("/soportetics", {"action":'editarvideologin', "idvideo":idvideo, "descripcion":descripcion}, function(data) {
                       if (data.result=='ok') {
                           $("#modalvideologin").modal("hide");
                           smoke.alert('Video Login Editado Correctamente');
                            setInterval(function(){
                                $.unblockUI();
                                location.href="/soportetics";
                            }, 3000);
                       }else{
                           $("#helpact").html("Error Vuelva a Intentarlo");
                       }
                    }, "json");
                    hideWaiting();
                }
            });


        });
    </script>
{% endblock %}
{% block canvas %}
    {% if verasistentes %}
        <hr>
        <div class='row-fluid'>
            <div class='span11'>
                <h3> Bloque de Datos de Soporte Tics</h3>
            </div>
            <div class='span1'>
                <a href="/" class='btn'><i class="icon-arrow-left"></i> Atr&aacute;s</a>
            </div>
        </div>
        <div class='row-fluid'>
            <b id="bfechatab">Fecha: </b><input type="text" name="fechatab" id="fechatab" value="{{ fechahoy|date:'Y-m-d' }}" class="input input-small" /><br/>
            <b id="bgeneral">General: </b><input type="checkbox" name="general" id="general" style="width: 4%;height: 2em" /><br><br>
        </div>
        <div class='row-fluid'>
            <div class='span6'>
                <div class="row-fluid">
                    <table class='table table-striped table-bordered' cellpadding="0" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Hora R.</th>
                                <th>Horario de HOY</th>
                                <th>Soporte</th>
                                <th>Filtro</th>
                                <th>Total Req.</th>
                                <th>Sin Finali.</th>
                                <th>Finalizado</th>
                                <th id="opchead"><a style="cursor: pointer" class="label label-info" id="ver" onclick="ver()"> Ver </a></th>
                            </tr>
                        </thead>
                        <tbody id="bodytble1">
                        </tbody>
                    </table>
                </div>
            </div>
            <div class='span6'>
                <div class="row-fluid">
                    <table class='table table-striped table-bordered' id="table2asis" cellpadding="0" cellspacing="0" style="display: None">
                        <thead>
                            <tr>
                                <th>Hora R.</th>
                                <th>Horario de HOY</th>
                                <th>Soporte</th>
                                <th>Filtro</th>
                                <th>Total Req.</th>
                                <th>Sin Finali.</th>
                                <th>Finalizado</th>
                                <th ></th>
                            </tr>
                        </thead>
                        <tbody id="bodytble2">
                        </tbody>
                    </table>
                </div>
            </div>
        </div><hr>
    {% endif %}

    <div class='row-fluid'>
        <div class='span11'>
            <h3> Requerimiento a Soporte Tics</h3>
            {% if   asistente2 %}
                <h4> Turno Actual de {{ asistente2.soporte.persona }}: {%  if asistente2.nolabora %} NO LABORA{% else %} {{ asistente2.horainicio|time:'H:i' }} - {{ asistente2.horafin|time:'H:i' }} {% endif %} <a style="cursor: pointer"  class='btn btn-info editturno '><i class="icon-edit icon-white"></i> Editar Turno </a></h4>   <br>
            {% endif %}
        </div>
        {% if not verasistentes %}
            <div class='span1'>
                <a href="/" class='btn'><i class="icon-arrow-left"></i> Atr&aacute;s</a>
            </div>
        {% endif %}
    </div>
    <div class='row-fluid'>
        <div class="span12">
            {% if horarioasistente and not asistente2 %}
                <a style="cursor: pointer" class='btn btn-info editturno'><i class="icon-edit icon-white"></i> Editar Turno </a>
            {% endif %}
            {% if verasistentes %}
                &nbsp;&nbsp;&nbsp;<b id=""> SOPORTE: </b>
                <select id='soporteasis' class="input-xlarge bigger"/>
                    <option value='0'>-----</option>
                    {% for a in asistententes %}
                        <option value="{{ a.id }}" {% if verasiiste.id == a.id %}selected="selected"{% endif %}>{{ a.persona.nombre_completo }}</option>
                    {% endfor %}
                </select><br>
            {% endif %}
            <form class='form-search' style="float: right">
{#                <a onclick="verchat()" class='btn btn-info'><i class="icon-refresh icon-white"></i> Chat </a>#}
                {% if not finali%}
                    <a href="/soportetics?finali=1{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}" id='allresults' class='btn btn-danger'><i class="icon-refresh icon-white"></i> Finalizados </a>
                {% else %}
                    <a href="/soportetics{% if verasiiste %}?idasis={{ verasiiste.id }}{% endif %}" id='allresults' class='btn btn-info'><i class="icon-refresh icon-white"></i> Sin Finalizar </a>
                {% endif %}
                {# BOTON DE VIDELOGIN   #}
                <a href="#" id='editarvideologin' class='btn btn-success'><i class="icon-plus icon-white"></i> Editar Video Login </a>

            </form>
        </div>
    </div>

    <div class="row-fluid">
        <div class='span12'>
            <form class="form-search"> <input class='searchinput input-xxlarge search-query' type='text' id='searchfield' value='{{ search }}'/>
                <a href="#" id='search' class='btn btn-info'><i class="icon-search icon-white"></i> Buscar</a>
                {% if search %}
                    <a href="/soportetics" id='allresults' class='btn btn-primary'><i class="icon-refresh icon-white"></i> Todos</a>
                {% endif %}
            </form>
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span12'>
        <table class='table table-striped table-bordered' cellpadding="0" cellspacing="0">
            <thead>
            <tr>
                <th>Soporte</th>
                <th>Horario Soporte</th>
                <th>Solicitante</th>
                <th>Tipo Problema</th>
                <th>Requerimiento</th>
                <th style="text-align: center;width: 8%">Archivo</th>
                <th>Fecha</th>
                <th>Finalizado</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            {% for r in requerimientos %}
                <tr>
                    <td>
                        {{ r.soporte.soporte.persona.nombre_completo }}
                        <a class="label label-info">Campus: {% if r.soporte.sede %}{{ r.soporte.sede }} {% else %} SIN CAMPUS{% endif %}</a>
                    </td>
                    <td style="width: 10%">
                         <b>Fecha: </b>{{ r.soporte.fecha|date:'Y-m-d' }}
                         <b>H. inicio - Fin </b>{{ r.soporte.horainicio|time:'H:i' }} - {{ r.soporte.horafin|time:'H:i' }}
                    </td>
                    <td>{{ r.persona }} <a class="label label-info">Campus: {% if r.sede %}{{ r.sede }} {% else %} SIN CAMPUS{% endif %}</a></td>
                    <td>{% if r.tipoproblema %}{{ r.tipoproblema }}{% endif %}</td>
                    <td>{{ r.requerimiento }}</td>
                    <td  style="text-align: center;width: 8%"> {% if r.archivo %} <a href='{{ r.archivo.url }}' class='btn btn-success btn-mini'><i class="icon-download icon-white"></i>Descargar</a> {% endif %}</td>
                    <td>
                        {{ r.fecha|date:"d-m-Y  H:i"  }}
                    </td>
                    <td style="text-align: center;">
                        <a>
                            {% if r.finalizado %}
                                <img src='/static/images/16/true.png' alt='Si' border='0'/>
                            {% else %}
                                <img src='/static/images/16/false.png' alt='No' border='0'/>
                            {% endif %}
                        </a>
                    </td>
                    <td>
                        <div class="btn-group">
                            <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
                                Acciones
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu pull-right">
                                {% if not r.finalizado %}
                                    {% if not asistente.programador  %}
                                        <li><a style="cursor: pointer" class="gestion" idreq='{{ r.id }}'><i class="icon-edit"></i> Ingresar Gesti√≥n</a></li>
                                        <li><a style="cursor: pointer" class="reasignar" idreq='{{ r.id }}' req='{{ r.requerimiento }}'><i class="icon-refresh"></i> Reasignar o Consulta </a></li>
                                    {% endif %}
                                {% endif %}
                                {% if r.existerespprogr  %}
                                    <li><a style="cursor: pointer" class="consultresp" idreq='{{ r.id }}'><i class="icon-edit"></i> Ver Consulta</a></li>
                                {% endif %}
{#                                {% if not asistente.programador  %}#}
                                    {% if r.existereqsolu %}
                                        <li><a style="cursor: pointer" class="vergestion" idreq='{{ r.id }}' req='{{ r.requerimiento }}'><i class="icon-eye-open"></i> Ver Gesti√≥n</a></li>
                                    {% endif %}
{#                                {% endif %}#}
                            </ul>
                        </div>
                    </td>
                </tr>
            {% endfor %}
            {% if not requerimientos %}
                <tr>
                    <td colspan="9">
                        NO HAY REQUERIMIENTOS SOLICITADOS
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>
        </div>
    </div>
    <div class='row-fluid'>
        <div class="span12">

            {% if paging.num_pages > 20 %}
                <div class='pagination'>
                    <ul>
                        {% if paging.primera_pagina %}
                            <li><a href="/soportetics?page=1{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}">1</a></li>
                            <li><a href="/soportetics?page={{ paging.ellipsis_izquierda }}{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}" class="active">...</a></li>
                        {% endif %}
                        {% for pagenumber in paging.paginas %}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/soportetics?page={{ pagenumber }}{% if finali %}&finali=1{% endif %}{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}">{{ pagenumber }}</a></li>
                        {% endfor %}
                        {% if paging.ultima_pagina %}
                            <li><a href="/soportetics?page={{ paging.ellipsis_derecha }}{% if finali %}&finali=1{% endif %}{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}" class="active">...</a></li>
                            <li><a href="/soportetics?page={{ paging.num_pages }}{% if finali %}&finali=1{% endif %}{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}">{{ paging.num_pages }}</a></li>
                        {% endif %}
                    </ul>
                </div>
            {% else %}

                <div class='pagination'>
                    <ul>
                        {% for pagenumber in paging.page_range %}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/soportetics?page={{ pagenumber }}{% if finali %}&finali=1{% endif %}{% if verasiiste %}&idasis={{ verasiiste.id }}{% endif %}{% if search %}&s={{ search }}{% endif %}">{{ pagenumber }}</a></li>
                        {% endfor %}
                    </ul>
                </div>

            {% endif %}

        </div>
    </div>
    
    <div class="modal fade static" id="nuevopanel" style="display: none;">
        <div class="modal-header alert-info" style="text-align: center">
            <h3 id="paneltitle1"> Ingrese su Gestion</h3>
        </div>
        <div class="modal-body">
            <textarea type='text' id='requerimiento' style="width:90%;" rows="6" cols="50" > </textarea>
            <p id="prequerimiento" style="color: red"></p><br/><br/>
            <b>Archivo: </b><input type="file" name="archivo" id="id_archivo" >
            <p class="help-text">Tamano Maximo permitido 40Mb </p>
            <p class="help-textr"></p>
            <b id="bfinaliza">Finaliza: </b><input type="checkbox" name="finaliza" id="finaliza" style="width: 5%;height: 2em;">
            <p id="pmensja" style="color: red"></p>
            <input type='hidden' id='action' value='addfirma'/>
            <input type='hidden' id='idrequeri' value='0'/>

        </div>
        <div class="modal-footer">
            <a  style="cursor: pointer;" id="firmcerrar" class="btn btn-cerrar">Cerrar</a>
            <a style="cursor: pointer;" id="ingresarfirm" class="btn btn-primary btn-resetear"> Ingresar</a>
        </div>
    </div>

    <div class="modal fade static" id="horaasistente" style="display: none;">
        <div class="modal-header alert-info" style="text-align: center">
            <h3 id="paneltitle1"> Ingresar Horario Laboral</h3>
        </div>
        <div class="modal-body" style="margin: 20px">
            <b id="bsede">Campus: </b>
            <select id='sede' class="input-xlarge bigger"/>
                <option value='-1'>-----</option>
                <option value='0' {% if not horarioasistente.sede %}selected="selected"{% endif %}> FUERA DE CAMPUS </option>
                {% for s in sedes %}
                    <option value="{{ s.id }}" {% if horarioasistente.sede.id == s.id %}selected="selected"{% endif %}>{{ s.nombre }}</option>
                {% endfor %}
            </select><br>
            <p id="psede" style="color: red"></p>
            <b id="binicio">H. Inicio: </b><input type="text" name="inicio" id="inicio" class="input input-small" value="{{ horarioasistente.horainicio|time:'H:i' }}" ><br>
            <p id="pinicio" style="color: red"></p>
            <b>H. Fin:&nbsp;&nbsp;&nbsp;&nbsp; </b><input type="text" name="fin" id="fin" class="input input-small" value="{{ horarioasistente.horafin|time:'H:i' }}"><br>
            <p id="pfin" style="color: red"></p>
            <b>No labora: </b><input type="checkbox" name="nolabora" id="nolabora" style="width: 10%;height: 5em;" {% if horarioasistente.nolabora %} checked {% endif %}>
            <p id="pmensja" style="color: red"></p>
        </div>
        <div class="modal-footer">
            <a  style="cursor: pointer;" id="cerrarmodal" class="btn btn-cerrar">Cerrar</a>
            <a style="cursor: pointer;" id="ingresarhorsop" class="btn btn-primary btn-resetear"> Ingresar</a>
        </div>
    </div>

    <div class="modal fade static" id="reasiganarmod" style="display: none;">
        <div class="modal-header">
            <h3>Requerimiento: </h3>
            <h4 id="panrequer"></h4>
        </div>
        <div class="modal-body" style="margin: 20px">

            <b>Programador: </b><input type="checkbox" name="chprogra" id="chprogra" style="width: 4%;height: 5em;" {% if not verasistentes %} disabled checked {% endif %}>
            <p id="pmensja" style="color: red"></p>
            <b>Seleccione el Soporte o Programador</b>
            <select id='reasigsoport' class="input-xxlarge bigger"/>
                <option value='0'>-----</option>
                {% for s in soportehorarios %}
                    <option value="{{ s.id }}" progra="{{ s.programador }}" >{{ s.soporte }}</option>
                {% endfor %}
            </select><br>
            <p id="preasigsoport" style="color: red"></p>
            <b id="bconsultareq" style="display: none">Consulta del Requerimiento: </b>
            <textarea type='text' id='consultareq' style="width:90%;display: none" rows="6" cols="50"> </textarea>
            <p id="pconsultareq" style="color: red"></p><br/><br/>
        </div>
        <div class="modal-footer">
            <a  style="cursor: pointer;" id="cerreasign" class="btn btn-cerrar">Cerrar</a>
            <a style="cursor: pointer;" id="ingresreasigsop" class="btn btn-primary btn-resetear"> Ingresar</a>
        </div>
    </div>

    <div class="modal fade static" id="vergestionpanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h3 >Gesti√≥n del Requerimiento</h3><br/>
            <h4 id='paneltitle2' ></h4>
        </div>
        <div class="modal-body" >

        </div>
        <div class="modal-footer" >
            <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>

    </div>

    {# MODAL VIDEO LOGIN    #}
<div class="modal fade static" id="modalvideologin">
    <div class="modal-header alert-info" style="text-align: center">
        <h3 id="paneltitle1"> Editar Video Login</h3>
    </div>
    <div class="modal-body" style="margin: 20px">
        <b>Descripcion: </b><input type="text" name="descripcion" id="id_descripcion" class="input input-small" value="{{ videologin.descripcion}}" ><br>
{#        <b>Activo: </b><input type="checkbox" name="chactivo" id="chactivo" style="width: 4%;height: 5em;"{% if videologin.activo %} checked {% endif %}>#}
        <p id="helpact" style="color: red"></p>
    </div>
    <div class="modal-footer">
        <button type="submit" class="btn btn-success btn-guardar">Guardar</button>
        <a href="#" class="btn btn-cerrar"> Cerrar</a>
    </div>
</div>

{% endblock %}