{% extends "basebs.html" %}
{% load sga_extras %}
{% block heading %}
    <script src="/static/js/smoke.min.js"></script>
    <link rel='stylesheet' type='text/css' href="/static/css/modules.css"/>
    <script src='/static/js/jquery.validationEngine.js' type="text/javascript"></script>
    <script src='/static/js/jquery.validationEngine-es.js' type="text/javascript"></script>
    <link type='text/css' rel='stylesheet' href="/static/css/validationEngine.jquery.css"/>
    <script type="text/javascript">
        $(function() {
            registros = {};
            var opcion='';
            $("#marcado").attr('checked',false);
            $(".descarga").click(function() {
                location.href = $(this).attr('url');
            });

            $("#tiposolsel").change(function() {
                var id = $(this).val();
                if (id){
                    location.href = '/solicitudes?t='+id;
                }else{
                    location.href = '/solicitudes';
                }
            });

            $("#search").click(function() {
                var term = $("#searchfield").val().toUpperCase();
                location.href = "/solicitudes?s="+term;
            });

            $('#searchfield').keyup(function(e) {
                if(e.keyCode == 13) {
                    $("#search").trigger("click");
                }
            });

            $("#asist").change(function() {
                var id = $(this).val();
                if (id){
                    location.href = "/solicitudes?op=buscar&asist="+id;
                }else{
                    location.href = "/solicitudes";
                }

            });

            $("input[type=checkbox]").change(function() {
                var val = $(this).is(":checked");
                var parent = $(this.parentNode);
                var indice = parseInt(parent.parent().attr('indice'));
                asignada=$(this).attr("idtrans");

                if (val) {
                    parent.parent().addClass("marcado");
                    registros[indice] = {'trans':asignada};
                }else{
                    parent.parent().removeClass("marcado");
                    delete registros[indice];
                }
            });

            registro = {
            {% for p in personas %}
                "{{ p.id }}": {"nombre":"{{ p.nombre_completo_inverso }}"}{% if not forloop.last %},{% endif %}
            {% endfor %}
            };

            {% if error %}
                smoke.alert('{{ error }}');
            {% endif %}
{#            ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#            /////////////////////////////ASIGNAR ASISTENTE  ///////////////////////////////////////////////////////////////////////////////////////////////#}
            $("form").validationEngine();
            $("#asignapanel #asitentes").addClass("validate[required]");

            var contasi=0;
            $(".asigasit").click(function(){

                $("#asignapanel #idsolici").val($(this).attr('idsoli'));
                $("#idasist").val("");
                $("#observacion").val("");
                contasi = contasi +1;
                $("#asignapanel #asitentes").val("");
                $("#asignapanel #paneltitle2").html($(this).attr('mensaje'));
                $("#asignapanel").modal({"backdrop":"static","width":"40%"});
                $("#asignapanel").modal("show");
                if (contasi == 1)
                {
                    $("#asignapanel #formbutton").click();
                    $("#asignapanel #formbutton").click();
                }
                $("#asignapanel .help-text").html('');
            });
            $("#asignapanel .btn-cerrar").click(function(){
                $("#asignapanel").modal("hide");
                return false;
            });

            $("#asignapanel #asitentes").change(function(){
                if ($("#asignapanel #asitentes").val()== '')
                {
                   $("#idasist").val('');
                }
                else{
                    $("#idasist").val($("#asignapanel #asitentes").val());
                    $("#asignapanel .help-text").html('');
                }

            });

            $("#asignapanel #formbutton").click(function(){

                if ($("#idasist").val() == '')
                {
                    $("#asignapanel .help-text").html('Este campo es obligatorio');
                }
                else
                {
                    $("#asignapanel .help-text").html('');
                }
                $(".formError").removeClass('aparece');
                $(".formError").addClass('oculta');
            });

             $(".vergestion").click(function(){
                idsoli = $(this).attr("idsoli");

                $.get("/solicitudes", {'action':'vergestion', 'ide': idsoli }, function(data) {
                        $("#detalle_gestion .modal-body").html(data);
                        $("#detalle_gestion").modal({"backdrop":"static"});
                        $("#detalle_gestion").modal("show");
                   }, "html");
                return false;
        });
          $("#detalle_gestion #cerrar").click(function() {
                $("#detalle_gestion").modal("hide");
            });

{#/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#///////////////////////CAMBIO DE TIPO SOLICITUD//////////////////////////////////////////////////////////////////////////#}

        $("#cambiotipopanel #tipo").addClass("validate[required]");

            var contasi=0;
            $(".tiposolicid").click(function(){

                $("#cambiotipopanel #idsolici").val($(this).attr('idsoli'));
                $("#idtipo").val("");
                $("#observacion").val("");
                contasi = contasi +1;
                $("#cambiotipopanel #tipo").val("");
                $("#cambiotipopanel #paneltitle2").html($(this).attr('mensaje'));
                $("#cambiotipopanel").modal({"backdrop":"static","width":"40%"});
                $("#cambiotipopanel").modal("show");
                if (contasi == 1)
                {
                    $("#cambiotipopanel #formbutton").click();
                    $("#cambiotipopanel #formbutton").click();
                }
                $("#cambiotipopanel .help-text").html('');
            });
            $("#cambiotipopanel .btn-cerrar").click(function(){
                $("#cambiotipopanel #observacion").html('');
                $("#cambiotipopanel").modal("hide");
                return false;
            });

            $("#cambiotipopanel #tipo").change(function(){
                if ($("#cambiotipopanel #tipo").val()== '')
                {
                   $("#idtipo").val('');
                }
                else{
                    $("#idtipo").val($("#cambiotipopanel #tipo").val());
                    $("#cambiotipopanel .help-text").html('');
                }
            });

            $('#cancelarusuario').click(function() {
               $("#reasigna_usuario").modal("hide");
            });

            $("#reasigna_usuario #reasignarusuario").click(function(){
                var usuario = $("#selectorusuario").val();
                if (opcion == '1') {
                    $.post("/solicitudes", {action: 'reasignarusuario', 'id':ide ,'usuario':usuario}, function(data) {
                            if (data.result=='ok') {
                                alert("REASIGNADO CORRECTAMENTE");
                                location.reload() ;

                            }
                            else{
                               smoke.alert('Error vuelva a intentarlo ' + data.e);
                            }
                    }, "json");
                }
                else
                {
                    $.post("/solicitudes", {action: 'reasignarusuarioengrupo', 'id':ide ,'usuario':usuario}, function(data) {
                            if (data.result=='ok') {
                                alert("REASIGNADAS CORRECTAMENTE");
                                location.href = "/solicitudes";
                            }
                            else{
                               smoke.alert('Error vuelva a intentarlo ' + data.e);
                            }
                    }, "json");
                }
            });

            $('#cancelrusuario').click(function() {
               $("#reasignarusuarioporgrupo").modal("hide");
            });

            $("#reasignarusuarioporgrupo #reasigusuario").click(function(){
                var usuario = $("#selectorusuario").val();
                $("#reasignarusuarioporgrupo").modal("hide");
                if (Object.keys(registros).length>0) {
                    $.post("/solicitudes", {action: 'reasignarusuariopormarcacion', 'id':ide ,'usuario':usuario,"datos": JSON.stringify(registros)}, function(data) {
                            if (data.result=='ok') {
                                alert("REASIGNADAS CORRECTAMENTE");
                                location.href = "/solicitudes";
                            }
                            else{
                               smoke.alert('Error vuelva a intentarlo ' + data.e);
                            }
                    }, "json");
                } else {
                }
                return false;
            });


             $(".reasignarasis").click(function(){
                ide = $(this).attr('eid');
                var op = $(this).attr("opt");
                opcion=op;
                $("#reasigna_usuario").modal({width: '400px', backdrop: 'static'});
                $("#reasigna_usuario").modal("show");
                 $.post("/solicitudes",{"action": "consultaasis",'id':ide },function(data) {
                       if(data.result=='ok'){
                                html = '<select id="selectorusuario">';
                                for (var n in data.usuarios){
                                     html = html + '<option value='+ data.usuarios[n].id +'>' + data.usuarios[n].usuario  +' </option>'
                                }
                                html = html + '</select>';
{#                                $('#detalle_tipo #sel').addClass('input-xlarge');#}
                                $("#datousuario").html(html);
                       }else{
                           alert(data.result);
                       }
                    },"json");
                });


            $("#cambiotipopanel #formbutton").click(function(){
                if ($("#idtipo").val() == '')
                {
                    $("#cambiotipopanel .help-text").html('Este campo es obligatorio');
                }
                else
                {
                    $("#cambiotipopanel .help-text").html('');
                }
                $(".formError").removeClass('aparece');
                $(".formError").addClass('oculta');
            });

{#///////////////////////FIN CAMBIO DE TIPO SOLICITUD//////////////////////////////////////////////////////////////////////#}

{#///////////////////////ASIGNAR PERSONA//////////////////////////////////////////////////////////////////////////#}

{#        $("#asignapersonapanel #tipo").addClass("validate[required]");#}
        $("#asignapersonapanel").addClass("validate[required]");

            var contasi=0;
            $(".asignar").click(function(){
                idsoli = $(this).attr("idsolici");
{#                $("#asignapersonapanel #idsolici").val();#}
                $("#id_persona").val("");
                $("#asignapersonapanel #id_observacion").val("");
                contasi = contasi +1;
                $("#asignapersonapanel #id_persona").val("");
                $("#asignapersonapanel #paneltitle2").html($(this).attr('mensaje'));
                $("#asignapersonapanel").modal({"backdrop":"static","width":"40%"});
                $("#asignapersonapanel").modal("show");
                if (contasi == 1)
                {
                    $("#asignapersonapanel #formbutton").click();
                    $("#asignapersonapanel #formbutton").click();
                }
                $("#asignapersonapanel .help-text").html('');
            });
            $("#asignapersonapanel .btn-cerrar").click(function(){
                $("#asignapersonapanel").modal("hide");
                return false;
            });

            $("#asignapersonapanel #id_persona").change(function(){
                if ($("#asignapersonapanel #id_persona").val()== '')
                {
                   $("#id_persona").val('');
                }
                else{

                    $("#id_persona").val();
                    $("#asignapersonapanel .help-text").html('');
                }
            });

            $("#ingresardato").click(function() {
                solicitud = idsoli;
                persona = $("#id_persona").val();
                observacion = $("#asignapersonapanel #id_observacion").val();

                $("#asignapersonapanel").modal("hide");
                if (solicitud!= ''){
                    if (persona != ''){
                        $.post("/solicitudes", {"action":"asignarpersona","solicitud":solicitud,"persona":persona,"observacion":observacion}, function(data) {
                                if (data.result=='ok') {
                                   location.reload();
                                }
                                else{
                                    smoke.alert('Error al Ingresar Informacion');
                                }
                        }, "json");
                    }
                     else{
                    smoke.alert('Seleccione Persona')
                    }
                }
                else{
                    smoke.alert('No existe Informacion')
                }
            });



{#///////////////////////FIN ASIGNAR PERSONA///////////////////////////////////////////////////////////////////#}





{#        ///////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////FINALIZAR SOLICITUD DE INCIDENCIA////////////////////////////////////////////////////#}
            var idsoli = 0;
            var contresp = 0;
            $("#observacionresp").addClass("validate[required]");

            $('.finalizar').click(function()
            {
                $("#resolucion").show();
                $("#labelresolucion").show();
                $("#labelobservacionresp").show();
                $("#resolucion").addClass("validate[required]");
                $("#seguimintcorreopanel #idsolici").val($(this).attr('idsoli'));
                $("#seguimintcorreopanel #idgrupo").val($(this).attr('grupos'));
                idinfo = 0;
                $("#seguimintcorreopanel #action").val('finalizasol');
                contresp = contresp + 1;
                $("#observacionresp").val("");
                $("#resolucion").val("");
                $("#seguimintcorreopanel #paneltitle1").html('Finalizar Incidencia');
                $("#seguimintcorreopanel #paneltitle3").html('');
                $("#seguimintcorreopanel #departamentos").val("");
                $("#seguimintcorreopanel #paneltitle2").html($(this).attr('mensaje'));
                $("#seguimintcorreopanel").modal({"backdrop":"static","width":"40%"});
                $("#seguimintcorreopanel").modal("show");
                if (contresp == 1)
                {
                    $("#seguimintcorreopanel #formbutton").click();
                    $("#seguimintcorreopanel #formbutton").click();
                }

            });
            $("#resolucion").blur(function(){
                if ($("#resolucion").val() == '')
                {
                    $("#seguimintcorreopanel .help-text2").html('Este campo es obligatorio');
                }
                else
                {
                    $("#seguimintcorreopanel .help-text2").html('');
                }
            });

{#        ///////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////VER SOLICITUD DE ALUMNO FINALIZADA////////////////////////////////////////////////////#}
           $(".verfinaliza").click(function() {


                $("#verfinalizadopanel .modal-body").html("<label><b>Respuesta:</b></label><textarea type='text' id='observacionresp' style='width:98%;text-transform: none' rows='6' cols='50' readonly> "+ $(this).attr('mensaje') +" </textarea><br/>" +
                                                            "<br/><b>Resoluci&oacute;n:</b><textarea type='text' id='observacionresp' style='width:98%;text-transform: none' rows='6' cols='50' readonly> "+ $(this).attr('resolucion') +" </textarea><br/>" +
                                                            "<br/><output style='border:1px solid #c7c7c7;padding:10px;border-radius: 2px;'> <b>Fecha Finalizacion:</b> "+ $(this).attr('fechafinaliza') +"</output>" +
                                                            "<br/><br/><output style='border:1px solid #c7c7c7;padding:10px;border-radius: 2px;'> <b>Usuario:</b> "+ $(this).attr('usuario') +"</output>");
                $("#verfinalizadopanel").modal({"backdrop":"static","width":"50%"});
                $("#verfinalizadopanel").modal("show");

                return false;
            });

            $("#verfinalizadopanel .btn-cerrar").click(function(){
                $("#verfinalizadopanel").modal("hide");
                return false;
            });

{#        ///////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////VER SOLICITUD DE ALUMNO ////////////////////////////////////////////////////#}

{#        ///////////////////////////////////////////////////////////////////////////////#}
{#        ////////////////////////////////////////////////////////////////////////////////#}
            $("#asignadepartpanel #departamentos").addClass("validate[required]");
            var contdep=0;
            $(".asigdepartamen").click(function(){
                $("#asignadepartpanel #idsolici").val($(this).attr('idinfo'));
                $("#iddepart").val("");
                contdep = contdep + 1;
                $("#observaciondepar").val("");
                $("#asignadepartpanel #departamentos").val("");
                $("#asignadepartpanel #paneltitle2").html($(this).attr('mensaje'));
                $("#asignadepartpanel").modal({"backdrop":"static","width":"40%"});
                $("#asignadepartpanel").modal("show");
                if (contdep == 1)
                {
                    $("#asignadepartpanel #formbutton").click();
                    $("#asignadepartpanel #formbutton").click();
                }
                $("#asignadepartpanel .help-text").html('');
            });
            $("#asignadepartpanel .btn-cerrar").click(function(){
                $("#asignadepartpanel").modal("hide");
                return false;
            });

            $("#asignadepartpanel #departamentos").change(function(){
                if ($("#asignadepartpanel #departamentos").val()== '')
                {
                   $("#iddepart").val('');
                }
                else{
                    $("#iddepart").val($("#asignadepartpanel #departamentos").val());
                    $("#asignadepartpanel .help-text").html('');
                }

            });

            $("#asignadepartpanel #formbutton").click(function(){

                if ($("#iddepart").val() == '')
                {
                    $("#asignadepartpanel .help-text").html('Este campo es obligatorio');
                }
                else
                {
                    $("#asignadepartpanel .help-text").html('');
                }
                $(".formError").removeClass('aparece');
                $(".formError").addClass('oculta');
            });

            {% if errordep %}
                smoke.alert('{{ errordep }}');
                setInterval(function(){
                    location.href = '/incidenciaadministrativa?action=correos';
                }, 2000);


            {% endif %}
         $("#resolucionmodal .btn-cerrar").click(function() {
                $("#resolucionmodal").modal('hide');
            });

{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
            var contresp=0;
            var idsoli = 0;
            $(".respondeconsult").click(function(){
                $("#resolucion").hide();
                $("#labelresolucion").hide();
                $("#labelobservacionresp").hide();
                $("#resolucion").removeClass("validate[required]");
                $("#seguimintcorreopanel #obsasistente").val($(this).attr('obasiste'));
                $("#seguimintcorreopanel #idsolici").val($(this).attr('idinfo'));
                idsoli = $(this).attr('idinfo');
                idinfo = 0;
                contresp = contresp + 1;
                $("#observacionresp").val("");
                $("#seguimintcorreopanel #paneltitle3").html('');
                $("#seguimintcorreopanel #departamentos").val("");
                $("#seguimintcorreopanel #paneltitle1").html($(this).attr('paneltitl'));
                $("#seguimintcorreopanel #paneltitle2").html($(this).attr('mensaje'));
                $("#seguimintcorreopanel").modal({"backdrop":"static","width":"40%"});
                $("#seguimintcorreopanel").modal("show");
                if (contresp == 1)
                {
                    $("#seguimintcorreopanel #formbutton").click();
                    $("#seguimintcorreopanel #formbutton").click();
                }

            });

            $("#seguimintcorreopanel #grupos").change(function(){
                if ($("#seguimintcorreopanel #grupos").val()== '')
                {
                   $("#idgrupo").val('');
                }
                else{

                    $("#idgrupo").val($("#seguimintcorreopanel #grupos").val());
                    $("#seguimintcorreopanel .help-text").html('');
                }
            });

            $("#seguimintcorreopanel .btn-cerrar").click(function(){
                $("#seguimintcorreopanel").modal("hide");
                contresp = 1;
                if (idinfo != 0)
                {
                    $.get("/incidenciaadministrativa", {'action':'detallpartamentos', 'iddepart': $("#seguimintcorreopanel #idsolici").val()}, function(data) {
                        $("#detalledepartamentopanel .modal-body").html(data);
                        $("#detalledepartamentopanel").modal({"backdrop":"static","width":'70%'});
                        $('#detalledepartamentopanel').show();
                    }, "html");
                    $("#seguimintcorreopanel #idsolici").val('');
                    return false;
                }
                else
                {
                    $("#seguimintcorreopanel #grupos").val('');
                    if ( nomdeparta != '' && mens != '' && iddepa != '')
                    {
                        detalledepartamento(nomdeparta,mens,iddepa);
                    }

                }

                $("#seguimintcorreopanel #action").val('respuestasolicitud');
                return false;
            });



            $("#seguimintcorreopanel #formbutton").click(function(){
                contresp = 1;

                if (idsoli != 0)
                {
                    $("#seguimintcorreopanel #idsolici").val(idsoli);
                    $("#seguimintcorreopanel #grupos").val();
                }
                if ($("#observacionresp").val() == '')
                {
                    $("#seguimintcorreopanel .help-text").html('Este campo es obligatorio');
                }
                else
                {
                    $("#seguimintcorreopanel .help-text").html('');
                }
                $(".formError").removeClass('aparece');
                $(".formError").addClass('oculta');
            });

{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}

            {#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
            var idinfo = 0;
            $(".verdepartament").click(function() {

                if ( idinfo == 0 || ($(this).attr("idinfo") != '' && $(this).attr("idinfo") != idinfo))
                {
                    idinfo = $(this).attr("idinfo");
                }
               $("#verdepartamentopanel #paneltitle2").html($(this).attr('mensaje'));
               $.get("/incidenciaadministrativa", {'action':'verdepartamentossolicitud', 'idinfo': idinfo}, function(data) {
                    $("#verdepartamentopanel .modal-body").html(data);
                    $("#verdepartamentopanel").modal({"backdrop":"static","width":"50%"});
                    $("#verdepartamentopanel").modal("show");
               }, "html");
               return false;
            });

            $("#verdepartamentopanel .btn-cerrar").click(function(){
                $("#verdepartamentopanel").modal("hide");
                return false;
            });

            $("#detalledepartamentopanel .btn-cerrar").click(function(){

                if (valida == 0)
                {
                    $("#detalledepartamentopanel").modal("hide");
                    $("#verdepartamentopanel #paneltitle2").html($(this).attr('mensaje'));
                    $.get("/incidenciaadministrativa", {'action':'verdepartamentossolicitud', 'idinfo': idinfo}, function(data) {
                        $("#verdepartamentopanel .modal-body").html(data);
                        $("#verdepartamentopanel").modal({"backdrop":"static","width":"50%"});
                        $("#verdepartamentopanel").modal("show");
                    }, "html");
                    return false;
                }
                else{
                    $("#detalledepartamentopanel").modal("hide");
                    valida = 0;
                    nomdeparta = '';
                    mens = '';
                    iddepa = '';
                    return false;
                }

            });
            var asigna = 0;
            {% if observacionincidencia %}
               asigna = 0;
               idinfo =  {{ observacionincidencia.departamentoincidenciaasig.incidenciaasignada.solicitusecret.id }}
               $("#detalledepartamentopanel #paneltitle1").html('Detalle de Departamento Asignado  ()');
               $("#detalledepartamentopanel #paneltitle2").html();
               detalledepartamento('{{ observacionincidencia.departamentoincidenciaasig.departamento.name }}','{{ observacionincidencia.departamentoincidenciaasig.incidenciaasignada.solicitusecret.mensaje }}','{{ observacionincidencia.departamentoincidenciaasig.id }}');
            {% endif %}

            var nomdeparta = '';
            var mens = '';
            var iddepa = '';

            $(".mensajeconsul").click(function(){
                nomdeparta = $(this).attr('nomdepart');
                mens = $(this).attr('mensaje');
                iddepa = $(this).attr('iddeppart');
                asigna = $(this).attr('asigna');
                detalledepartamento(nomdeparta,mens,iddepa)
            });
             $(".addgestion").click(function(){

                    idsoli = $(this).attr("idsoli");
                    var nom = $(this).attr("non");
                    $("#seguimiento_panel").modal({width: '600px', backdrop: 'static'});
                    $("#seguimiento_panel").modal("show");
                    $("#seguimiento_panel #paneltitle1").html(nom);
                 $('#seguimiento_panel #id_observacion').val('')
                   return false;
            });
             $("#seguimiento_panel .cerrar").click(function() {
                    $("#seguimiento_panel").modal("hide");
                     return false;

            });
             $("#seguimiento_panel .adicionar").click(function() {
                $("#seguimiento_panel").modal("hide");
                $.post("/solicitudes",{"action": "addgestion", "idsol":idsoli,"observacion": $('#seguimiento_panel #id_observacion').val()},function(data) {
                    if(data.result=='ok'){
                       alert('REGISTRO GUARDADO');
                       location.reload();
                      }else{
                       smoke.alert('OCURRIO UN ERROR: ' + (data.result));
                      }
                    },"json");

            });
            bloquea =  function(){
                    $("#id_referencia").attr("disabled",true);
                    $("#id_cuentabanco").val("");
                    $("#id_cuentabanco").attr("disabled",true);
                    $("#id_valor").val("");
                    $("#id_valor").attr("disabled",true);
                    $("#id_deposito").attr("disabled",true);
                    $("#id_transferencia").attr("disabled",true);
                };
            $(".ver").click(function(){
                 bloquea();
                $("#id_autorizado").attr("disabled",true);
                $("#id_motivoautoriza").attr("disabled",true);
                if(($(this).attr("autorizado")) == 'True'){
                    $("#id_autorizado").attr('checked',true);

                }else{
                    $("#id_autorizado").attr('checked',false);

                }

                ids = $(this).attr("idsoli");
                var nom = $(this).attr("non");
                $("#resolucionmodal").modal({width: '600px', backdrop: 'static'});
                $("#resolucionmodal").modal("show");
                $("#id_referencia").val($(this).attr("refer"));
                $("#id_cuentabanco").val($(this).attr("cta"));
                $("#id_motivoautoriza").val($(this).attr("desc"));
                $("#id_valor").val($(this).attr("valor"));
                if(($(this).attr("deposito")) == 'True'){
                    $("#id_deposito").attr('checked',true);

                }else{
                    $("#id_deposito").attr('checked',false);

                }
                if(($(this).attr("deposito")) == 'False'){
                    $("#id_transferencia").attr('checked',true);
                }else{
                    $("#id_transferencia").attr('checked',false);

                }


               return false;
        });


            var valida = 0;

            function detalledepartamento(title1,title2,iddep){
               valida = 1;
               $("#detalledepartamentopanel #paneltitle1").html('Detalle de Departamento Asignado  ('+ title1 +')');
               $("#detalledepartamentopanel #paneltitle2").html(title2);
               $.get("/incidenciaadministrativa", {'action':'detallpartamentos', 'iddepart': iddep,'asigna':asigna}, function(data) {
                    $("#detalledepartamentopanel .modal-body").html(data);
                    $("#detalledepartamentopanel").modal({"backdrop":"static","width":'70%'});
                    $('#detalledepartamentopanel').show();
{#                    $("#verdepartamentopanel").modal("hide");#}
                }, "html");
                return false;
            }
        {#        ///////////////////////////////////////////////////////////////////////////////////////////////////////#}
{#        //////////////////////////////////////////////////////////////////////////////////////////////////////#}

            $(".verasistente").click(function() {
                idinfo = $(this).attr("idinfo");
               $("#verasistentasigpanel #paneltitle2").html($(this).attr('mensaje'));
               $.get("/seguimiento", {'action':'verasistentessoli', 'idinfo': idinfo}, function(data) {
                    $("#verasistentasigpanel .modal-body").html(data);
                    $("#verasistentasigpanel").modal({"backdrop":"static","width":"60%"});
                    $("#verasistentasigpanel").modal("show");
               }, "html");
               return false;
            });

            $("#verasistentasigpanel .btn-cerrar").click(function(){
                $("#verasistentasigpanel").modal("hide");
                return false;
            });

            $(".btn-reasignarvarios").click(function() {
                ide = $(this).attr('aid');
                var op = $(this).attr("opt");
                opcion = op;
                $("#reasigna_usuario").modal({width: '400px', backdrop: 'static'});
                $("#reasigna_usuario").modal("show");
                $.post("/solicitudes",{"action": "consultaasiscaja",'id':ide },function(data) {
                   if(data.result=='ok'){
                            html = '<select id="selectorusuario">';
                            for (var n in data.usuarios){
                                 html = html + '<option value='+ data.usuarios[n].id +'>' + data.usuarios[n].usuario  +' </option>'
                            }
                            html = html + '</select>';
                            $("#datousuario").html(html);
                   }else{
                       alert(data.result);
                   }
                },"json");
            });

            $(".btn-reasignaenlote").click(function() {
                ide = $(this).attr('aid');
                $.post("/solicitudes",{"action": "reasignaenlote",'id':ide },function(data) {
                   if(data.result=='ok'){
                       alert("REASIGNADAS EN LOTE CORRECTAMENTE");
                       location.href = "/solicitudes";
                   }else{
                        if(data.result == 'bad2'){
                            alert("NO HAY CAJEROS DISPONIBLES");
                            location.href = "/solicitudes";
                        }
                        else{
                            alert(data.result);
                            }
                   }
                },"json");
            });

            $(".btn-reasignarseleccion").click(function() {
                ide = $(this).attr('aid');
                $("#reasignarusuarioporgrupo").modal({width: '400px', backdrop: 'static'});
                $("#reasignarusuarioporgrupo").modal("show");
                $.post("/solicitudes",{"action": "consultaasiscaja",'id':ide },function(data) {
                   if(data.result=='ok'){
                            html = '<select id="selectorusuario">';
                            for (var n in data.usuarios){
                                 html = html + '<option value='+ data.usuarios[n].id +'>' + data.usuarios[n].usuario  +' </option>'
                            }
                            html = html + '</select>';
                            $("#datousuario2").html(html);
                   }else{
                       alert(data.result);
                   }
                },"json");
            });

            $(".ver2").click(function() {
                var obs=$(this).attr("obs2");
                smoke.alert(obs);
            });

        });
    </script>
    <style type="text/css">
        .oculta{
            display: none;
        }
        .aparece{
            display: block;
        }
    </style>
{% endblock %}
{% block canvas %}
    <div class='row-fluid'>
        <div class='span11'>

        </div>
        <div class='span1'>
{#            <a href="/{% if departa  or asistente %}incidenciaadministrativa{% else %}seguimiento{% endif %}" class='btn'><i class="icon-arrow-left"></i> Atras</a>#}
            <a href="/controlespecies" class='btn'><i class="icon-arrow-left"></i> Atras</a>
{#            <a href="/inscripciones?i=1" class='btn btn-warning'> Inactivos</a>#}
        </div>
    </div>
    <div class='row-fluid' >
        <div class='span6'>
            <h3>Solicitudes de Alumnos</h3>
{#            <h5>Periodo: {{ periodo }}</h5><br>#}
            {% if not cerrado and not departamento %}
{#                <a href="/{% if departa  or asistente %}incidenciaadministrativa?action=solicitudes&{% else %}seguimiento?action=solicitudes&{% endif %}cerra=cerrada" id='allresults' class='btn btn-danger'><i class="icon-eye-open icon-white"></i> Solicitudes Finalizadas</a>#}
                <a href="/solicitudes?cerra=cerrada" id='allresults' class='btn btn-danger'><i class="icon-eye-open icon-white"></i> Solicitudes Finalizadas</a>

            {% else %}
                {% if not departamento %}
{#                    <a href="{% if departa  or asistente %}incidenciaadministrativa?action=solicitudes{% else %}seguimiento?action=solicitudes{% endif %}" id='allresults' class='btn btn-primary'><i class="icon-refresh icon-white"></i>&nbsp;Solicitudes x Atender</a>#}
                    <a href="/solicitudes" id='allresults' class='btn btn-primary'><i class="icon-refresh icon-white"></i> &nbsp;Solicitudes x Atender</a>
                {% endif %}
            {% endif %}
            {% if asistentefilter %}
                 <h4> Tr&aacute;mites Por Gestionar: {{ asignados }} Gestionados: {{ gestionados }}</h4>
                 <h4> Solicitudes Por Gestionar: {{ asistentefilter.cantidadsol }}  Solicitudes Gestionados: {{ solicitudgestionadas }}</h4>
            {% endif %}
        </div>
        <div class='span6' style="text-align: left">
            {% if asistentes %}
                <div style="text-align: left" class='span5'>
                <b>Asistentes </b>
                   <select id="asist" class="input-xlarge bigger">
                        <option value="">-----</option>
                        {% for a in asistentes %}'
                        <option  {% if asistentefilter.id == a.id %}selected="selected"{% endif %} value="{{ a.id }}" >{{ a.persona.nombre_completo_inverso }}</option>
                        {% endfor %}
                   </select>
                </div>
            {% endif %}
            {% if asistentefilter %}
                  <a href="/solicitudes" id='allresults' class='btn btn-primary'><i class="icon-refresh icon-white"></i> Todos</a>
            {% endif %}
        </div>
    </div>
    <div class='row-fluid'>
        <div class='span5'><br>
            <form class="form-search">
            <input class='searchinput input-large search-query' type='text' id='searchfield' value='{{ search }}'/>
            <a href="#" id='search' class='btn btn-info'><i class="icon-search icon-white"></i> Buscar</a>
            {% if search %}
                <a href="/solicitudes" id='allresults' class='btn btn-primary'><i class="icon-refresh icon-white"></i> Todos</a>
            {% endif %}
            </form>
        </div>
        <div class='span5'><br>
            {% if perms.sga.change_factura %}
                {% if asistentefilter and cantsolicitud > 0 %}
                    <a href="#" class="btn btn-reasignarvarios btn-warning" aid={{ asistentefilter.id }} opt="2" > <i class="icon-check"></i> Reasignar todas</a>
                    <a href="#" class="btn btn-reasignaenlote btn-success" aid={{ asistentefilter.id }} > <i class="icon-check"></i> Reasignar en Lotes</a>
                {% endif %}
            {% endif %}
            {% if perms.sga.change_solicitudsecretariadocente %}
                {% if asistentefilter and cantsolicitud > 0 %}
                    <a href="#" class="btn btn-reasignarseleccion btn-info" aid={{ asistentefilter.id }}> <i class="icon-check"></i> Reasignar Seleccionados</a>
                {% endif %}
            {% endif %}
        </div>
    </div>

{#    </div>#}
    <div class='row-fluid' >
        <div class='span13'><br>
        <table class='table table-bordered table-striped' cellpadding="0" cellspacing="0">
            <thead>
            <tr>
                <th style="text-align: center">#</th>
                <th>Estudiante</th>
                <th>Grupo</th>
                <th>Fecha Solicitud</th>
                <th>Hora Solicitud</th>
                <th>Tipo</th>
                <th>Descripci&oacute;n</th>
                <th>Observaci&oacute;n</th>
                <th>Departamento Actual</th>
                <th>Fecha Asignado</th>
                <th>Hora Asignado</th>
                <th>Asignado</th>
                <th>Soporte</th>
                <th >Finalizado</th>
                {% if perms.sga.change_solicitudsecretariadocente %}
                    <th >Seleccionar</th>
                {% else %}
                    <th></th>
                {% endif %}
                <th>Calificaci&oacute;n</th>
                <th></th>
            </tr>
            </thead>
            <tbody>
            {% for solicitud in solicitudes %}
                <tr class='{% cycle "odd" "even" %}' indice='{{ forloop.counter }}'>
                    <td>{{ solicitud.id }}
                        {% if solicitud.solicitudestudiante.presencial %}
                            <br/><span class="label label-success">Presencial </span>
                        {% endif %}
                    </td>
                    <td>{{ solicitud.persona }}
                        {% if solicitud.solicitudestudiante.tipoe.id == ID_TIPO_SOLICITUD %}
                           {% if not  solicitud.asistenteautoriza  and not solicitud.cerrada %}
                                <span class="label label-warning "> Pendiente de Autorizar </span>
                            {% else %}
                                {% if solicitud.autorizado   %}
                                    <span class="label label-success ">  Autorizado:  {{ solicitud.asistenteautoriza.persona.usuario }}</span>
                                {% else %}
                                    {% if  not solicitud.autorizado  and  solicitud.asistenteautoriza %}
                                        <span class="label label-warning "> No Autorizado </span>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                            {% if solicitud.datosaprobacion %}
                                {% if not solicitud.datosaprobacion.disponible  %}
                                    <span class="label label-info "> Facturado
                                        {{ solicitud.datosaprobacion.pago }}
                                    </span>
                                {% endif %}

                            {% endif %}
                        {% endif %}
                    </td>

                    <td>{{ solicitud.persona.inscripcion.grupo.nombre }}</td>
                    {% if  solicitud.solicitudestudiante %}
                        <td>{{ solicitud.solicitudestudiante.fecha|date:"d-m-Y" }}</td>
                        <td>{{ solicitud.solicitudestudiante.fecha|time:"h:i a" }}</td>
                    {% endif %}

                    <td>{{ solicitud.tipo }}</td>
                    <td>
                        {{ solicitud.descripcion }} {% if solicitud.ctabanco %} <br> <b>{{ solicitud.ctabanco  }}</b>{% endif %}
                        {% if solicitud.referencia %}<b>Ref. {{ solicitud.referencia  }}</b>{% endif %}<br/>
                        {% if not solicitud.cerrada %}
{#                            <a href="/solicitudes?action=comentar&id={{ solicitud.id }}" class='btn btn-info btn-mini'><i class="icon-envelope icon-white"></i> Responder</a>#}
{#                            <a href="/solicitudes?action=cerrar&id={{ solicitud.id }}" class="btn btn-danger btn-mini"><i class="icon-remove icon-white"></i> Cerrar</a>#}
                        {% endif %}
                    </td>

                    <td>{% if solicitud.observacion %} {{ solicitud.observacion }}{% endif %}</td>
                    <td> {{ solicitud.departamento }}</td>
                    {% if  solicitud.tienegestion %}
                            <td>{{ solicitud.ultima_gestion.fecha|date:"d-m-Y" }}</td>
                            <td>{{ solicitud.ultima_gestion.fecha|time:"h:i a" }}</td>
                        {% else %}

                            <td>{{ solicitud.fechaasignacion|date:"d-m-Y" }}</td>
                            <td>{{ solicitud.fechaasignacion|time:"h:i a" }}</td>
                        {% endif %}
                    <td>{% if solicitud.personaasignada %} {{ solicitud.personaasignada.usuario }}
                    {% if solicitud.tiene_horario %}
                       <br><b>Turno Actual: {%  if  solicitud.tiene_horario.nolabora %} NO LABORA{% else %} {{  solicitud.tiene_horario.horainicio|time:'H:i' }} - {{  solicitud.tiene_horario.horafin|time:'H:i' }} {% endif %}</b>
                    {% endif %}{% endif %}

                    </td>
                    <td style="text-align: center"> {% if solicitud.comprobante %}<a href='{{ solicitud.descargar }}' class='descarga' style="cursor: pointer"> Descargar</a> {% endif %}

                    </td>
                    <td style="text-align: center">
                        {% if solicitud.cerrada %}
                            <img src='/static/images/16/true.png' border='0'/>
                        {% else %}
                            <img src='/static/images/16/false.png' border='0'/>
                        {% endif %}
                    </td>
                    <td style="text-align: center">
                        {% if perms.sga.change_solicitudsecretariadocente %}
                            {% if solicitud.tipo.id == ID_PAGO_RUBROS and not solicitud.cerrada %}
                                <input type='checkbox' idtrans='{{ solicitud.id }}' id='check' />
                            {% endif %}
                        {% endif %}
                    </td>
                    <td>
                        {% if  solicitud.solicitudestudiante %}
                            {% if solicitud.cerrada and solicitud.solicitudestudiante.calificacion %}
                                {{ solicitud.solicitudestudiante.calificacion }}
                            {% endif %}
                        {% endif %}
                    </td>
                    <td>
                        <div class="btn-group">
                            <a class="btn btn-mini dropdown-toggle" data-toggle="dropdown" href="#">
                                Acciones
                                <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu pull-right">
                            {% if solicitud.personaasignada.usuario == usuario and  solicitud.solicitudestudiante.tipoe.id != ID_TIPO_SOLICITUD   or   usuario.is_superuser or solicitud.personaasignada.usuario == usuario and solicitud.solicitudestudiante.tipoe.id == ID_TIPO_SOLICITUD and solicitud.asistenteautoriza%}
{#                            {% if solicitud.personaasignada.usuario == usuario   and solicitud.tipo.id == ID_TIPO_SOLICITUD and solicitud.asistenteautoriza  or   usuario.is_superuser %}#}
                                {% if not solicitud.cerrada %}
                                        {% if solicitud.asignado  %}
{#                                                <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="asigasit"><i class="icon-eye-open"></i> Reasignar Asignado</a></li>#}
                                            <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="tiposolicid"><i class="icon-circle-arrow-right"></i> Cambiar Departamento </a></li>
                                        {% else %}
{#                                                <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="asigasit"><i class="icon-circle-arrow-right"></i> Asignar Asistente</a></li>#}
                                            <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="tiposolicid"><i class="icon-circle-arrow-right"></i> Cambiar Tipo Solicitud</a></li>
                                            <li><a style="cursor: pointer" idsolici='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="asignar"><i class="icon-circle-arrow-right"></i> Asignar Persona </a></li>
                                        {% endif %}

                                        {% if  solicitud.personaasignada.usuario == usuario and  solicitud.solicitudestudiante.tipoe.id != ID_TIPO_SOLICITUD  or solicitud.solicitudestudiante.tipoe.id == ID_TIPO_SOLICITUD  and solicitud.asistenteautoriza and     solicitud.personaasignada.usuario == usuario %}
                                            {% if not solicitud.existe_solicipractica %}
                                                <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="finalizar"><i class="icon-circle-arrow-right"></i> Finalizar Solicitud </a></li>
                                            {% else %}
                                                <li>
                                                    <a style="cursor: pointer"
                                                       href="/solicitud_practicasadm?action=solicitud&ides={{ solicitud.existe_solicipractica.escenariopractica.id }}&idsol={{ solicitud.existe_solicipractica.id }}">
                                                        <i class="icon-eye-open"></i> Debe Gestionar Solicitud para Finalizar </li>
                                                    </a>
                                            {% endif %}
                                        {% endif %}
                                        <li><a href="#" class="addgestion" idsoli="{{ solicitud.id }}" non="{{solicitud.descripcion }}"><i class="icon-plus"></i> Ingresar Gesti&oacute;n </a></li>
                                        {% if  solicitud.solicitudestudiante.tipoe.id == ID_TIPO_SOLICITUD  %}
                                            {% if not  solicitud.asistenteautoriza  %}
                                                <li><a href="#" class="autorizar" idsoli="{{ solicitud.id }}"  non="{{solicitud.descripcion }}" ><i class="icon-eye-open"></i> Resoluci&oacute;n/Autorizaci&oacute;n </a></li>
                                            {% else %}
                                                <li><a href="#" class="ver" idsoli="{{ solicitud.id }}"  non="{{solicitud.descripcion }}"  autorizado="{{solicitud.autorizado }}" desc="{{solicitud.motivoautoriza }}" refer="{{ solicitud.datosaprobacion.referencia }}" valor="{{ solicitud.datosaprobacion.valor }}" cta="{{ solicitud.datosaprobacion.cuentabanco.id }}"  deposito="{{ solicitud.datosaprobacion.deposito }}" ><i class="icon-eye-open"></i> Ver Aprobacion </a></li>
                                            {% endif %}
                                        {% endif %}
                                {% endif %}
                            {% endif %}
                             {% if perms.sga.change_asistentedepartamento %}
                                <li><a style="cursor: pointer" idsoli='{{ solicitud.id }}' mensaje="{{ solicitud.descripcion }}" class="tiposolicid"><i class="icon-circle-arrow-right"></i> Cambiar Departamento </a></li>
                                 {% if solicitud|args:persona|call:"puede_reasignar" %}
                                    <li><a href="#" eid="{{ solicitud.id }}" class="reasignarasis" opt="1"><i class="icon-user"></i> Reasignar Usuario </a></li>
                                 {% endif %}
                            {% endif %}
                            {% if  solicitud.tienegestion %}
                                <li><a href="#" class="vergestion" idsoli="{{ solicitud.id }}"  non="{{solicitud.descripcion }}" ><i class="icon-eye-open"></i> Ver Gesti&oacute;n </a></li>
                            {% endif %}
                            {% if solicitud.cerrada %}
                                {% if solicitud.solicitudestudiante.obscalificacion %}
                                    <li><a href="#" class="ver2" obs2="{{ solicitud.solicitudestudiante.obscalificacion }}" ><i class="icon-eye-open"></i> Ver Obs.Calificaci&oacute;n</a></li>
                                {% endif %}
                            {% endif %}
                            </ul>
                        </div>
                    </td>
                </tr>
            {% endfor %}
            {% if not solicitudes %}
                <tr><td colspan="5">NO EXISTEN SOLICITUDES</td></tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    </div>
    <div class='row-fluid'>
        <div class="span12">
            <div class='pagination'>

                {% if paging.num_pages > 20 %}
                <div class='pagination'>
                    <ul>
                        {% if paging.primera_pagina %}
{#                            <li><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&page=1{% if cerrado %}&cerra=cerrada{% endif %}">1</a></li>#}
{#                            <li><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&page={{ paging.ellipsis_izquierda }}{% if cerrado %}&cerra=cerrada{% endif %}" class="active">...</a></li>#}
                            <li><a href="/solicitudes?&page={{ paging.ellipsis_izquierda }}{% if cerrado %}&cerra=cerrada{% endif %}{% if tipo %}&t={{ tipoid }}{% endif %}" class="active">...</a></li>
                        {% endif %}
                        {% for pagenumber in paging.paginas %}
{#                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&page={{ pagenumber }}{% if cerrado %}&cerra=cerrada{% endif %}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>#}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/solicitudes?&page={{ pagenumber }}{% if cerrado %}&cerra=cerrada{% endif %}{% if tipo %}&t={{ tipoid }}{% endif %}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>

                        {% endfor %}
                        {% if paging.ultima_pagina %}
{#                            <li><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&page={{ paging.ellipsis_derecha }}{% if cerrado %}&cerra=cerrada{% endif %}" class="active">...</a></li>#}
{#                            <li><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&page={{ paging.num_pages }}{% if cerrado %}&cerra=cerrada{% endif %}">{{ paging.num_pages }}</a></li>#}
                            <li><a href="/solicitudes?&page={{ paging.num_pages }}{% if cerrado %}&cerra=cerrada{% endif %}{% if tipo %}&t={{ tipoid }}{% endif %}">{{ paging.num_pages }}</a></li>
                        {% endif %}
                    </ul>
                </div>
            {% else %}

                <div class='pagination'>
                    <ul>
                        {% for pagenumber in paging.page_range %}
{#                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/{% if departa  or asistente %}incidenciaadministrativa?{% else %}seguimiento?{% endif %}action=solicitudes&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}{% if cerrado %}&cerra=cerrada{% endif %}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>#}
                            <li {% if pagenumber == page.number %}class='active'{% endif %}><a href="/solicitudes?&{% if search %}s={{ search }}&{% endif %}page={{ pagenumber }}{% if cerrado %}&cerra=cerrada{% endif %}{% if tipo %}&t={{ tipoid }}{% endif %}{% if activos %}&a={{ activos }}{% endif %}{% if inactivos %}&i={{ inactivos }}{% endif %}{% if todos %}&t={{ todos }}{% endif %}{% if grupoid %}&g={{ grupoid }}{% endif %}">{{ pagenumber }}</a></li>
                        {% endfor %}
                    </ul>
                </div>

            {% endif %}
            </div>
        </div>
    </div>

    <div class="modal fade static" id="asignapanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4   >Asignar Asistente a Solicitud de Alumno:  </h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/seguimiento" method="POST"  >
                <input type='hidden' name='action' value='asignasitente'/>
                <input type='hidden' id='idsolici' name='idsolici' />
                <input type='hidden' id='idasist' name='idasist' />
                <input type='hidden' name='editar' id='editar' value="0"/>

{#                <fieldset class="control-group nomargins">#}

                    <div class="controls" style="margin-left: 1%">
                        ASISTENTES:
                        <select id='asitentes'  />
                            <option value=''>-----</option>
                            {% for g in asistasuntoestudiant %}
                                <option value="{{ g.id }}" {% if grupoid == g.id %}selected="selected"{% endif %}>{{ g.asistente }}</option>
                            {% endfor %}
                        </select>
                        <p class="help-text">{{ field.help_text }} </p>
                        <br/><br/>
                        <textarea type='text' id='observacion' style="width:98%;text-transform: uppercase" rows="6" cols="50" name='observacion'> </textarea>

                    </div>
{#                </fieldset>#}
                <br/><br/><button type="submit" class="btn btn-success" id="formbutton" style="float: right">Guardar</button>
                <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
            </form>
        </div>
    </div>


    <div class="modal fade static" id="seguimintcorreopanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4 id='paneltitle1' >Ingrese Respuesta</h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >
            <h5 id='paneltitle3' ></h5>
           {#  <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/{% if not departa  and not asistente %}seguimiento{% else %}incidenciaadministrativa{% endif %}" method="POST"  >#}
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/solicitudes" method="POST"  >
           {#  <input type='hidden' name='action' id='action' value='respuestasolicitud'/>#}
                <input type='hidden' name='action' id='action' value='finalizasol'/>
                <input type='hidden' id='idsolici' name='idsolici' />
                <input type='hidden' id='idgrupo' name='idgrupo' />
                    <div class="controls" style="margin-left: 1%">
                        <label id="labelobservacionresp" style="display: none"><b>Respuesta:</b></label><textarea type='text' id='observacionresp' style="width:98%;text-transform:none" rows="6" cols="50" name='observacionresp' > </textarea>
                        <p class="help-text">{{ field.help_text }} </p>
                        <br/><br/><label id="labelresolucion" style="display: none"><b>Resolucion:</b></label> <textarea type='text' id='resolucion' style="width:98%;text-transform: none;display:none" rows="6" cols="50" name='resolucion' > </textarea>
                        <p class="help-text2">{{ field.help_text }} </p><br/>
                        {# aqui agregar los departamentos para que el dpto de origen o de donde proviene la solicitud sea notificado #}
{#                        DEPARTAMENTO ORIGEN:#}
{#                        <select id='grupos' />#}
{#                            <option value=''>-----</option>#}
{#                            {% for g in grupos %}#}
{#                                <option value="{{ g.id }}" {% if grupoid == g.id %}selected="selected"{% endif %}>{{ g.name }}</option>#}
{#                            {% endfor %}#}
{#                        </select>#}
{#                        <br/><br/>#}
                        {# hasta aqui los  departamentos             #}
                    </div>
                <br/><br/><button type="submit" class="btn btn-success" id="formbutton" style="float: right">Guardar</button>
                <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
            </form>
        </div>
    </div>


    <div class="modal fade static" id="verfinalizadopanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4 ></h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >

        </div>
        <div class="modal-footer" >
            <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>

    </div>



    <div class="modal fade static" id="asignadepartpanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4   >Asignar Departamento a Correo de Informacion:  </h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/incidenciaadministrativa" method="POST"  >
                <input type='hidden' name='action' value='asigdepartsolicitud'/>
                <input type='hidden' id='idsolici' name='idsolici' />
                <input type='hidden' id='iddepart' name='iddepart' />
                <input type='hidden' name='editar' id='editar' value="0"/>

{#                <fieldset class="control-group nomargins">#}

                    <div class="controls" style="margin-left: 1%">
                        DEPARTAMENTOS:
                        <select id='departamentos' />
                            <option value=''>-----</option>
                            {% for d in departamentos %}
                                <option value="{{ d.id }}" {% if grupoid == g.id %}selected="selected"{% endif %}>{{ d.name }}</option>
                            {% endfor %}
                        </select>
                        <p class="help-text">{{ field.help_text }} </p>
                        <br/><br/>
                        <textarea type='text' id='observaciondepar' style="width:98%;text-transform: uppercase" rows="6" cols="50" name='observaciondepar'> </textarea>

                    </div>
{#                </fieldset>#}
                <br/><br/><button type="submit" class="btn btn-success" id="formbutton" style="float: right">Guardar</button>
                <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
            </form>
        </div>
    </div>


    <div class="modal fade static" id="detalledepartamentopanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4 id='paneltitle1'>Detalle de Departamento Asignados</h4><br/>
            <h5 id='paneltitle2' ></h5>
            <h5 id='paneltitle3' ></h5>
        </div>
        <div class="modal-body" style="word-wrap: break-word" >

        </div>
        <div class="modal-footer" >
            <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>

    </div>


    <div class="modal fade static" id="verdepartamentopanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4 >Departamentos Asignados</h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >

        </div>
        <div class="modal-footer" >
            <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>

    </div>


    <div class="modal fade static" id="verasistentasigpanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4 >Asistentes Asignados</h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >

        </div>
        <div class="modal-footer" >
            <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>

    </div>

    <div class="modal fade static" id="cambiotipopanel">
        <div class="modal-header" style="word-wrap: break-word">
            <h4>Cambiar Departamento:  </h4><br/>
            <h5 id='paneltitle2' ></h5>
        </div>
        <div class="modal-body" >
            <form id="formulario" style="overflow-y: auto"  class='well form-horizontal' action="/solicitudes" method="POST"  >
                <input type='hidden' name='action' value='cambiotipo'/>
                <input type='hidden' id='idsolici' name='idsolici' />
                <input type='hidden' id='idtipo' name='idtipo' />
                <input type='hidden' name='editar' id='editar' value="0"/>

                    <div class="controls" style="margin-left: 1%">
                        Departamento:
                        <select id='tipo'  />
                            <option value=''>-----</option>
                            {% for t in tiposolicitud %}
                                <option value="{{ t.id }}" {% if grupoid == t.id %}selected="selected"{% endif %}>{{ t.descripcion }}</option>
                            {% endfor %}
                        </select>
                        <p class="help-text">{{ field.help_text }} </p>
                        <br/><br/>
                        <textarea type='text' id='observacion' style="width:98%;text-transform: uppercase" rows="6" cols="50" name='observacion'> </textarea>
                    </div>
                <br/><br/><button type="submit" class="btn btn-success" id="formbutton" style="float: right">Guardar</button>
                <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
            </form>
        </div>
    </div>

    <div class="modal fade static" id="asignapersonapanel">
        <div class="modal-header">
            <h3 class="paneltitle">Asignar Persona</h3>
        </div>
        <div class="modal-body">
            <form id="formulario" class='form-horizontal' action="" method="POST" style="text-align:  left;">
{#                <input type='hidden' id='idsolici' name='idsolici' />#}
                {% for field in form %}
                    <fieldset class="control-group nomargins">
                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>
                        <div class="controls">
                            {{ field }}
                            <p class="help-text">{{ field.help_text }} </p>
                        </div>
                    </fieldset>
                {% endfor %}
            </form>
        </div>
        <div class="modal-footer">
             <a href="#" id="ingresardato" class="btn btn-success"><i class=""></i> Guardar</a>
             <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>
    </div>


    <div class="modal fade static" id="reasigna_usuario"   >
        <div class="row-fluid modal-header">
             <h4  id='paneltitle1'><i> </i></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >
        <div id="datousuario">

        </div>
        </div>
        <div class="modal-footer">
            <div >
                <a style="float: left" href="#" id="cancelarusuario" class="btn btn-danger  btn-cancelar">  <i  class="icon-remove icon-white"></i> <b> CANCELAR </b></a>
                <a style="float: left" href="#" id="reasignarusuario" class="btn btn-success  btn-reasignar">  <i  class="icon-plus icon-white"></i> <b> REASIGNAR </b></a>

            </div>
        </div>
    </div>

    <div class="modal fade static" id="reasignarusuarioporgrupo"   >
        <div class="row-fluid modal-header">
             <h4  id='paneltitle1'><i> </i></h4>
            <h5></h5>
        </div>
        <div class="modal-body" >
        <div id="datousuario2">

        </div>
        </div>
        <div class="modal-footer">
            <div >
                <a style="float: left" href="#" id="cancelrusuario" class="btn btn-danger  btn-cancelar">  <i  class="icon-remove icon-white"></i> <b> CANCELAR </b></a>
                <a style="float: left" href="#" id="reasigusuario" class="btn btn-success  btn-reasignar">  <i  class="icon-plus icon-white"></i> <b> REASIGNAR </b></a>

            </div>
        </div>
    </div>

<div class="modal fade static" id="detalle_gestion"   >
    <div class="row-fluid modal-header">
        <h4 ><i> DETALLES  </i></h4>
        <h5></h5>
    </div>
    <div class="modal-body" >

    </div>
    <div class="modal-footer">
        <div style="float: right">
            <a href="#" id="cerrar" class="btn btn-success  btn-aceptar">ACEPTAR</a>
        </div>
    </div>
</div>

     <div class="modal fade static" id="seguimiento_panel" style="display: none;"  >
        <div class="modal-header">
            <h4  id='paneltitle1'><i>  </i></h4>
        </div>
        <div class="modal-body" style="text-align: left">
            <form id="formulario5"  action="" method="POST">
            {% for field in segform %}
                <fieldset class="control-group nomargins">
                <label style="text-align: left;"  for="id_{{ field.name }}"><b>{{ field.label }}:</b></label>
                    <div class="controls">
                        {{ field }}
                        <p class="help-text">{{ field.help_text }} </p>
                    </div>
                </fieldset>
            {% endfor %}
            </form>

        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-buscar btn-success adicionar">Guardar</a>
            <a href="#" class="btn btn-cerrar btn-info cerrar">Salir</a>
        </div>
    </div>

    <div class="modal fade static" id="resolucionmodal">
        <div class="modal-header">
            <h3 class="paneltitle">Resoluci&oacute;n / Autorizaci&oacute;n</h3>
        </div>
        <div class="modal-body">
            <form id="formulario" class='form-horizontal' action="" method="POST" style="text-align:  left;">
{#                <input type='hidden' id='idsolici' name='idsolici' />#}
                {% for field in formresol %}
                    <fieldset class="control-group nomargins">
                        <label class="control-label" for="id_{{ field.name }}">{{ field.label }}</label>
                        <div class="controls">
                            {{ field }}
                            <p class="help-text">{{ field.help_text }} </p>
                        </div>
                    </fieldset>
                {% endfor %}
            </form>
        </div>
        <div class="modal-footer">
             <a href="#" id="ingresardato" class="btn btn-success"><i class=""></i> Guardar</a>
             <a  class="btn btn-cerrar" style="float: right;cursor: pointer"> Cerrar</a>
        </div>
    </div>
{% endblock %}